/*!
 * 
 * MCAFEE RESTRICTED CONFIDENTIAL
 * Copyright (c) 2020 McAfee, LLC
 * 
 * The source code contained or described herein and all documents related
 * to the source code ("Material") are owned by McAfee or its
 * suppliers or licensors. Title to the Material remains with McAfee
 * or its suppliers and licensors. The Material contains trade
 * secrets and proprietary and confidential information of McAfee or its
 * suppliers and licensors. The Material is protected by worldwide copyright
 * and trade secret laws and treaty provisions. No part of the Material may
 * be used, copied, reproduced, modified, published, uploaded, posted,
 * transmitted, distributed, or disclosed in any way without McAfee's prior
 * express written permission.
 * 
 * No license under any patent, copyright, trade secret or other intellectual
 * property right is granted to or conferred upon you by disclosure or
 * delivery of the Materials, either expressly, by implication, inducement,
 * estoppel or otherwise. Any license under such intellectual property rights
 * must be expressed and approved by McAfee in writing.
 * 
 * 
 */!function(e){function t(t){for(var s,n,r=t[0],i=t[1],o=0,c=[];o<r.length;o++)n=r[o],Object.prototype.hasOwnProperty.call(a,n)&&a[n]&&c.push(a[n][0]),a[n]=0;for(s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s]);for(E&&E(t);c.length;)c.shift()()}var s={},a={1:0};var n={};var r={109:function(){return{"./wasm_lib.js":{__wbg_new_de17f04ab3be4063:function(){return s[107].exports.__wbg_new_de17f04ab3be4063()},__wbindgen_string_new:function(e,t){return s[107].exports.__wbindgen_string_new(e,t)},__wbg_set_e11a72d9733dadef:function(e,t,a){return s[107].exports.__wbg_set_e11a72d9733dadef(e,t,a)},__wbindgen_object_drop_ref:function(e){return s[107].exports.__wbindgen_object_drop_ref(e)},__widl_f_new_with_str_and_init_Request:function(e,t,a){return s[107].exports.__widl_f_new_with_str_and_init_Request(e,t,a)},__wbg_globalThis_4fa2faeae7a7a380:function(){return s[107].exports.__wbg_globalThis_4fa2faeae7a7a380()},__wbg_self_ed02073ec1d8fef4:function(){return s[107].exports.__wbg_self_ed02073ec1d8fef4()},__wbg_window_356847be61f4a80f:function(){return s[107].exports.__wbg_window_356847be61f4a80f()},__wbg_global_6580a67633b0dbc1:function(){return s[107].exports.__wbg_global_6580a67633b0dbc1()},__wbindgen_is_undefined:function(e){return s[107].exports.__wbindgen_is_undefined(e)},__wbg_newnoargs_0c3c518a7f7c56bf:function(e,t){return s[107].exports.__wbg_newnoargs_0c3c518a7f7c56bf(e,t)},__wbg_call_aa56d0132fec7569:function(e,t){return s[107].exports.__wbg_call_aa56d0132fec7569(e,t)},__wbindgen_object_clone_ref:function(e){return s[107].exports.__wbindgen_object_clone_ref(e)},__widl_instanceof_Window:function(e){return s[107].exports.__widl_instanceof_Window(e)},__widl_f_fetch_with_request_Window:function(e,t){return s[107].exports.__widl_f_fetch_with_request_Window(e,t)},__widl_f_error_2_:function(e,t){return s[107].exports.__widl_f_error_2_(e,t)},__widl_instanceof_Response:function(e){return s[107].exports.__widl_instanceof_Response(e)},__widl_f_text_Response:function(e){return s[107].exports.__widl_f_text_Response(e)},__wbindgen_string_get:function(e,t){return s[107].exports.__wbindgen_string_get(e,t)},__widl_f_error_1_:function(e){return s[107].exports.__widl_f_error_1_(e)},__wbg_call_34f87007c5d2a397:function(e,t,a){return s[107].exports.__wbg_call_34f87007c5d2a397(e,t,a)},__widl_f_log_1_:function(e){return s[107].exports.__widl_f_log_1_(e)},__wbindgen_debug_string:function(e,t){return s[107].exports.__wbindgen_debug_string(e,t)},__wbindgen_throw:function(e,t){return s[107].exports.__wbindgen_throw(e,t)},__wbindgen_cb_drop:function(e){return s[107].exports.__wbindgen_cb_drop(e)},__wbg_then_1fa2e92ee4bdbc93:function(e,t){return s[107].exports.__wbg_then_1fa2e92ee4bdbc93(e,t)},__wbg_then_486e2e2b1fb1bbf4:function(e,t,a){return s[107].exports.__wbg_then_486e2e2b1fb1bbf4(e,t,a)},__wbg_resolve_04ca3cb0d333a4f0:function(e){return s[107].exports.__wbg_resolve_04ca3cb0d333a4f0(e)},__wbg_new_5e8d465c199e6ff3:function(e,t){return s[107].exports.__wbg_new_5e8d465c199e6ff3(e,t)},__wbindgen_closure_wrapper360:function(e,t,a){return s[107].exports.__wbindgen_closure_wrapper360(e,t,a)}}}}};function i(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(e){var t=[],s=a[e];if(0!==s)if(s)t.push(s[2]);else{var o=new Promise(function(t,n){s=a[e]=[t,n]});t.push(s[2]=o);var c,l=document.createElement("script");l.charset="utf-8",l.timeout=120,i.nc&&l.setAttribute("nonce",i.nc),l.src=function(e){return i.p+""+({31:"wasm_lib"}[e]||e)+".bundle.js"}(e);var E=new Error;c=function(t){l.onerror=l.onload=null,clearTimeout(_);var s=a[e];if(0!==s){if(s){var n=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;E.message="Loading chunk "+e+" failed.\n("+n+": "+r+")",E.name="ChunkLoadError",E.type=n,E.request=r,s[1](E)}a[e]=void 0}};var _=setTimeout(function(){c({type:"timeout",target:l})},12e4);l.onerror=l.onload=c,document.head.appendChild(l)}return({31:[109]}[e]||[]).forEach(function(e){var s=n[e];if(s)t.push(s);else{var a,o=r[e](),c=fetch(i.p+""+{109:"ed4865b68a3ab15fef23"}[e]+".module.wasm");if(o instanceof Promise&&"function"==typeof WebAssembly.compileStreaming)a=Promise.all([WebAssembly.compileStreaming(c),o]).then(function(e){return WebAssembly.instantiate(e[0],e[1])});else if("function"==typeof WebAssembly.instantiateStreaming)a=WebAssembly.instantiateStreaming(c,o);else{a=c.then(function(e){return e.arrayBuffer()}).then(function(e){return WebAssembly.instantiate(e,o)})}t.push(n[e]=a.then(function(t){return i.w[e]=(t.instance||t).exports}))}}),Promise.all(t)},i.m=e,i.c=s,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(s,a,function(t){return e[t]}.bind(null,a));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e},i.w={};var o=window.webpackJsonp=window.webpackJsonp||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var E=c;i(i.s=105)}({0:function(e,t,s){"use strict";s.d(t,"a",function(){return a}),s.d(t,"b",function(){return n}),s.d(t,"c",function(){return r}),s.d(t,"d",function(){return i}),s.d(t,"e",function(){return o}),s.d(t,"g",function(){return c}),s.d(t,"m",function(){return l}),s.d(t,"h",function(){return E}),s.d(t,"k",function(){return _}),s.d(t,"l",function(){return d}),s.d(t,"n",function(){return u}),s.d(t,"o",function(){return T}),s.d(t,"i",function(){return h}),s.d(t,"j",function(){return S}),s.d(t,"f",function(){return g});const a={GREEN:0,YELLOW:1,RED:2,UNKNOWN:3,HACKERSAFE:4,TYPOSQUATTING:5,PHISHING:6,*[Symbol.iterator](){for(const e of Object.keys(this))"GREEN"!==e&&"HACKERSAFE"!==e&&"UNKNOWN"!==e&&(yield this[e])}},n={UNKNOWN:-1,FIREFOX:1,CHROME:2,IRON_SOURCE:3,EDGE:4},r={BROWSER_TYPE:2,DEBUG_MODE:!1,EXTENSION_VERSION:"8.0.0.37123",LOG_LEVEL:0,PPS_MODE:!1},i={GREEN:0,YELLOW:1,RED:2,UNKNOWN:3,HACKERSAFE:4},o={RAISE_NEW_TAB_EVENT:3,UPDATE_CACHE_STATS:4},c={[a.GREEN]:"green",[a.YELLOW]:"yellow",[a.RED]:"red",[a.UNKNOWN]:"white",[a.HACKERSAFE]:"hackersafe"},l={[a.GREEN]:"green",[a.YELLOW]:"yellow",[a.RED]:"red",[a.PHISHING]:"phishing",[a.UNKNOWN]:"unknown",[a.HACKERSAFE]:"green"},E={NONE:-1,LEGACY:0,V1:1},_={MINIMAL:15,UNKNOWN:30,MEDIUM:50},d={SHOW_BALLOON:1,HIDE_BALLOON:2},u={BADGE_COLLECTION:"BADGE_COLLECTION",BLOCK_PAGE:"BLOCK_PAGE",DOWNLOAD_SCANNING_MALICIOUS:"DOWNLOAD_SCANNING_MALICIOUS",DOWNLOAD_SCANNING_FILE_DELETED:"DOWNLOAD_SCANNING_FILE_DELETED",DOWNLOAD_SCANNING_FILE_NOT_DELETED:"DOWNLOAD_SCANNING_FILE_NOT_DELETED",IFRAME_BLOCK:"IFRAME_BLOCK",SITE_REPORT:"SITE_REPORT",SS_ACCEPTED:"SS_ACCEPTED"},T=e=>{const t={};return Object.keys(e).forEach(s=>{t[e[s]]=s}),t},h={FF:"https://www.siteadvisor.com/searchextension/searchextension.xpi"},S={CH:"https://chrome.google.com/webstore/detail/mcafee%C2%AE-secure-search/enppghjcblldgigemljohkgpcompnjgh"},g={SIDEBAR:"mc-sidebar-container",TOPBAR:"mc-topbar-container",TOAST:"mc-toast-container",PAGE_OVERLAY:"mc-page-overlay-container"}},1:function(e,t,s){"use strict";s.d(t,"a",function(){return a});const a=chrome},10:function(e,t,s){"use strict";s.d(t,"a",function(){return i}),s.d(t,"b",function(){return o}),s.d(t,"d",function(){return c}),s.d(t,"c",function(){return E}),s.d(t,"e",function(){return _}),s.d(t,"f",function(){return d});var a=s(6),n=s(0),r=s(8);const i={NONE:0,INFO:1,ERROR:2,ALL:3},o={INFO:1,ERROR:2},c={BACKGROUND:"BACKGROUND",CONTENT:"CONTENT",TELEMETRY:"TELEMETRY"},l={DEFAULT:"color: black; font-weight: normal; font-style:normal;",BACKGROUND:"color: #8D0DBA; font-weight: bold;",CONTENT:"color: #F54A26; font-weight: bold;",TELEMETRY:"color: #147831; font-weight: bold;"};class E{constructor(){this.nativeLogging=!1,this.browserType=n.c.BROWSER_TYPE,this.extensionType="wa"}setNativeLogging(e){a.a.useNativeLogger=e,this.nativeLogging=e}processLog(e,t,s){if(this.nativeLogging){const n={processType:t,browserType:this.browserType,extensionType:this.extensionType,logType:s,message:e};a.a.messageDispatcher.logger(n)}_(e,s,t)}log(e,t=c.BACKGROUND){this.processLog(e,t,i.INFO)}error(e,t=c.BACKGROUND){this.processLog(e,t,i.ERROR)}}const _=(e,t,s)=>{const a=d(),n=`%c[${s} - ${(new Date).toLocaleString()}]: %c${e}`,r=l.DEFAULT,c=l[s];a!==i.NONE&&(t!==o.ERROR||a!==i.ERROR&&a!==i.ALL||console.error(n,r,r),t!==o.INFO||a!==i.INFO&&a!==i.ALL||console.log(n,c,r))},d=()=>{const e=n.c.LOG_LEVEL,t=a.a.cacheStore.get(r.c.EXTENSION_LOGGING);return t&&Number.isInteger(t)&&Object.values(i).includes(t)?t:e}},105:function(e,t,s){"use strict";s.r(t);var a=s(6);class n{constructor(){this.resolve=null,this.reject=null,this.promise=null,this.command=null,this.commandParams=null,this.pThis=null}createPromise(e,t,s,a,n,r){return this.resolve=t,this.reject=s,this.command=a,this.commandParams=n,this.pThis=r,this.promise=new Promise(e),this.promise}}const r={ACTIVATE:"activate",ON_DOWNLOAD_FINISHED:"onDownloadFinished",REPORT_STAT:"reportStat",ON_DSS_REQUEST:"onDssRequest",ON_BEFORE_NAVIGATE:"onBeforeNavigate",ON_NAVIGATE:"onNavigate",ON_DOC_COMPLETE:"onDocComplete",EXECUTE_COMMAND:"executeCommand",ON_MENU_ITEM_CLICK:"onMenuItemClick",SET_SYSTEM_OPTION_STRING:"setSystemOptionString",GET_SYSTEM_OPTION_STRING:"getSystemOptionString",GET_SYSTEM_OPTION_BOOL:"getSystemOptionBool",GET_SYSTEM_OPTION_INT:"getSystemOptionInt",LOG_MSG:"logMsg"};var i=s(9),o=s(11);class c{constructor(e){this._port=e,this._callbackId=i.a.MAX_RESERVED_CALLBACK_ID,this._messageMap={0:{}},this._viewport=null,this._contextCounter=0,this._contextMap=new Map,this.mcafee_wa_jscommands={getxyviewport:"getxyviewport"}}init(e){try{if(null!==this._port){if(this._port.onDisconnect.addListener(()=>{e({init:!1,disabled:!1})}),!this.setSystemOptionString(i.b.SETTINGS.BROWSER_TYPE,a.a.browserType.toString()))return;if(!this.setSystemOptionString(i.b.SETTINGS.USER_AGENT,navigator.userAgent))return;if(!this.nativeMsg([r.ACTIVATE]))return;e({init:!0,disabled:disabled}),this.getSystemOptionString(i.b.SETTINGS.AFF_ID,"0",e=>{a.a.AFFID=e}),this.getBingSecureSearchSettings()}}catch(e){return a.a.logger.error(e.message),!1}}nativeMsg(e){let t=!1;try{const s=[1,0].concat(e);t=this.postMessage(s)}catch(e){return a.a.logger.error(e.message),!1}return t}logger(e){try{const{message:t,logLevel:s}=e,n=[1,0,r.LOG_MSG,s,t];this._port.postMessage(n)}catch(t){a.a.logger.setNativeLogging(!1),a.a.logger.error(`Failed to log with details: ${JSON.stringify(e)}. Exception: ${t.message}`)}}postMessage(e){try{this._port.postMessage(e)}catch(e){return this._port.disconnect(),this._port=null,a.a.logger.error(e.message),!1}return!0}addNewContext(e,t,s,a){const n=`${t}${s}`;this._contextMap.has(n)||this._contextMap.set(n,{tab_id:t,frame_id:s,context_id:e,url:a})}getContextObj(e){const t=this._contextMap.entries();for(const s of t)if(s[1].context_id===e)return s[1];return null}processOption(){}SetXYViewport({xView:e,yView:t}){if(null!==this._viewport&&this._viewport.X===e&&this._viewport.Y===t)return;const s=`${e},${t}`;this._viewport={X:e,Y:t},this.setSystemOptionString(i.b.SETTINGS.VIEWPORT,s)}processInwardMessage(e){if(e.length<3)return[];switch(a.a.logger.log(`Processing message from binary: ${e[2]} ${e[3]} ${e[4]} ${e[5]}`),e[2]){case this.mcafee_wa_jscommands.getxyviewport:return this.getXYViewport()}}validateJSON(e){if(e.length<2)return;const t=parseInt(e[0],10);if(t>i.a.MAX_RESERVED_CALLBACK_ID){const s=this._messageMap[t];if(!s)return;s.waPromise.resolve({response:e,callback:s.callback,promise:s.waPromise}),delete this._messageMap[t]}else{const t=this.processInwardMessage(e);this.postMessage([0,e[1],t])}}setSystemOptionString(e,t){return this.nativeMsg([r.SET_SYSTEM_OPTION_STRING,e,t])}getSystemOptionString(e,t,s){const a=void 0===s?null:s;return this.makePromise(r.GET_SYSTEM_OPTION_STRING,a,[e,t])}getSystemOptionBool(e,t,s){const a=void 0===s?null:s;return this.makePromise(r.GET_SYSTEM_OPTION_BOOL,a,[e,t])}getSystemOptionInt(e,t,s){const a=void 0===s?null:s;return this.makePromise(r.GET_SYSTEM_OPTION_INT,a,[e,t])}uninit(){null!==this._port&&(this._port.disconnect(),this._port=null)}then(e){try{switch(e.promise.command){case r.GET_SYSTEM_OPTION_BOOL:{const t=null===e.response[1]||e.response[1];e.promise.pThis.processOption(e.promise.commandParams[0],t),null!==e.callback&&e.callback(t);break}case r.GET_SYSTEM_OPTION_STRING:e.promise.pThis.processOption(e.promise.commandParams[0],e.response[1]),null!==e.callback&&e.callback(e.response[1]);break;case r.GET_SYSTEM_OPTION_INT:{let t;"null"===e.response[1]?[,t]=e.promise.commandParams:[,t]=e.response,e.promise.pThis.processOption(e.promise.commandParams[0],t),null!==e.callback&&e.callback(t);break}}}catch(e){a.a.logger.error(e.message)}}makePromise(e,t,s){const a=++this._callbackId,r=new n,i=r.createPromise(()=>{const t=[1,a,e].concat(s);this.postMessage(t)},this.then,null,e,s,this);return this._messageMap[a]={waPromise:r,callback:t},i.then(this.then),!0}onDownloadFinished(e,t,s){const a=null===e?"":e;return this.nativeMsg([r.ON_DOWNLOAD_FINISHED,t,s,a]),!1}onSettings(){return this.nativeMsg([r.ON_MENU_ITEM_CLICK,114,""]),!1}generateContextId(e,t){const s=`${e}${t}`;return this._contextMap.has(s)?this._contextMap.get(s).context_id:(this._contextCounter++,2147483647&(0|this._contextCounter))}executeCommand({command_id:e}){this.nativeMsg([r.EXECUTE_COMMAND,e,""])}getBingSecureSearchSettings(){this.getSystemOptionString(i.b.SETTINGS.SYSTEM_GEO,"",e=>{this.getSystemOptionString(i.b.SETTINGS.BING_COUNTRY_SET,i.b.BING_COUNTRY_SET_STRING,t=>{this.getSystemOptionInt(i.b.SETTINGS.PROVIDER_FORCED,-1,s=>{if(""!==e&&""!==t&&-1!==s){t.split(",").includes(e)&&s===o.c.BING&&(a.a.SECURE_SEARCH_PROVIDER=s)}})})})}pushCacheToNative(){}sendTelemetry(){}cryptojackingHandler(){}}var l=s(0);class E{constructor(){this.callbackId=i.a.MAX_RESERVED_CALLBACK_ID,this.callbackMap=new Map,this.defaultResponseCb=null,this.port=null}incrementCallbackId(){return(this.callbackId<0||this.callbackId>=2147483647)&&(this.callbackId=i.a.MAX_RESERVED_CALLBACK_ID),this.callbackId++}onMessageResponse(e){if(!("request_type"in e&&"id"in e&&"payload"in e))return void a.a.logger.log(`Invalid native json message: ${JSON.stringify(e)} `);const{id:t}=e;this.callbackMap.has(t)?(this.callbackMap.get(t)(e),this.callbackMap.delete(t)):this.defaultResponseCb(e)}init(e,t){this.port=e,this.defaultResponseCb=t,this.port.onMessage.addListener(this.onMessageResponse.bind(this)),this.port.onDisconnect.addListener(()=>{this.port=null})}postMessage(e,t){try{const s=this.incrementCallbackId();e.id=s,"function"==typeof t&&this.callbackMap.set(s,t),this.port.postMessage(e)}catch(e){this.port.disconnect(),a.a.logger.error(e.message)}}}var _=s(21);var d=class{static isDomainInWhitelist(e,t){const s=_.a.getCleanURI(e);if(!s)return a.a.logger.error("Trying to put an empty URL into whitelist!"),!1;const n=a.a.cacheStore.get(t)||[];if(!Array.isArray(n))return a.a.logger.error("Can not fetch whitelist properly!"),!1;for(let e=0;e<n.length;e+=1){const t=s.toLowerCase(),a=n[e].toLowerCase();if(t.includes(a)||a.includes(t))return!0}return!1}static addDomainsToWhitelist(e,t){if(!Array.isArray(e)||0===e.length)return;const s=[];if(e.forEach(e=>{const a=_.a.getCleanURI(e);a&&!this.isDomainInWhitelist(a,t)&&s.push(a)}),s.length>0){const e=a.a.cacheStore.get(t)||[];if(!Array.isArray(e))return;const n=e.concat(s);a.a.cacheStore.set(t,n)}}static removeDomainFromWhitelist(e,t){if(!Array.isArray(e)||0===e.length)return;const s=[];if(e.forEach(e=>{const a=_.a.getCleanURI(e);this.isDomainInWhitelist(a,t)&&s.push(a.toLowerCase())}),s.length>0){const e=a.a.cacheStore.get(t)||[];if(!Array.isArray(e))return;const n=e.filter(e=>!s.includes(e.toLowerCase()));a.a.cacheStore.set(t,n)}}static getDomainsFromWhitelist(e){return a.a.cacheStore.get(e)||[]}static clearWhitelist(e){a.a.cacheStore.clear(e)}};class u{constructor(e){this.dispatcher=e,this.settings=[]}add(e,t,s,a){this.settings.push({name:e,value:t,scope:s,type:a})}send(){this.dispatcher&&this.dispatcher.setValues(this.settings)}}var T=s(8);const h={PAGES_SCANNED:"PAGES_SCANNED",PAGES_BLOCKED:"PAGES_BLOCKED",DOWNLOADS_SCANNED:"DOWNLOADS_SCANNED",DOWNLOADS_BLOCKED:"DOWNLOADS_BLOCKED",IFRAMES_BLOCKED:"IFRAMES_BLOCKED",ADS_BLOCKED:"ADS_BLOCKED",TRACKER_BLOCKED:"TRACKER_BLOCKED",CRYPTO_BLOCKED:"CRYPTO_BLOCKED"};class S{static init(e){const t=this.read(),{CRYPTO_BLOCKED:s,DOWNLOADS_BLOCKED:n,DOWNLOADS_SCANNED:r,PAGES_BLOCKED:o,PAGES_SCANNED:c}=i.b.SETTINGS,l={pagesScanned:e[c]||t.pagesScanned,pagesBlocked:e[o]||t.pagesBlocked,downloadsScanned:e[r]||t.downloadsScanned,downloadsBlocked:e[n]||t.downloadsBlocked,iframesBlocked:t.iframesBlocked,adsBlocked:t.adsBlocked,trackersBlocked:t.trackersBlocked,cryptoBlocked:e[s]||t.cryptoBlocked};a.a.cacheStore.set(T.c.POPUP_STATS,l)}static add(e){const t=this.read();switch(e){case h.PAGES_SCANNED:t.pagesScanned++;break;case h.PAGES_BLOCKED:t.pagesBlocked++;break;case h.DOWNLOADS_SCANNED:t.downloadsScanned++;break;case h.DOWNLOADS_BLOCKED:t.downloadsBlocked++;break;case h.IFRAMES_BLOCKED:t.iframesBlocked++;break;case h.ADS_BLOCKED:t.adsBlocked++;break;case h.TRACKER_BLOCKED:t.trackersBlocked++;break;case h.CRYPTO_BLOCKED:t.cryptoBlocked++;break;default:return}a.a.cacheStore.set(T.c.POPUP_STATS,t)}static read(){const e={pagesScanned:0,pagesBlocked:0,downloadsScanned:0,downloadsBlocked:0,iframesBlocked:0,adsBlocked:0,trackersBlocked:0,cryptoBlocked:0},t=a.a.cacheStore.get(T.c.POPUP_STATS);return t&&Object.assign(e,t),e}}var g=s(1);class A{static focusOrCreateTab(e){g.a.tabs.query({currentWindow:!0},t=>{for(const{id:s,url:a}of t)if(a.includes(e)||e.includes(a))return void g.a.tabs.update(s,{active:!0,url:e},()=>{});g.a.tabs.create({url:e})})}}var O=s(10),m=s(7),p=s(13),N=s(2);const I={GET_VALUES_RESPONSE:0,EXECUTE_COMMAND:1,REDIRECT_URL:3,REFRESH:4,RESTART:5,LOGMSG:6,HANDSHAKE_GREETING:8,EXTENSION_STATE_RESPONSE:9,GENERIC_NATIVE_REQUEST:12,DOWNLOAD_SCAN_RESULT:13,DELETE_FILE_RESULT:14},b={GET_VALUES:0,SET_VALUES:1,EXECUTE_COMMAND:2,LOG_MSG:6,ON_DOWNLOAD_FINISHED:7,ON_SETTINGS_CLICK:8,HANDSHAKE_GREETING:9,AGGREGATE_DATA:11,GET_EXTENSION_STATUS:12,INSTALL_EXTENSION:13,TELEMETRY:14,EXTENSION_STATUS_UPDATE:15,AUTO_PLAY_VIDEO_SITE:16,CRYPTOJACKING_HANDLER:17,GET_CACHE_REQUEST:18,ADD_CACHE_REQUEST:19,SHOULD_SHOW_TOAST:20,MFW_REQUEST:21,DOWNLOAD_SCANNING_DELETE_FILE:22},{STRING:D,INT:R,BOOL:C}=i.b.SETTINGS_TYPE,{SYSTEM:L,USER:f}=i.b.SCOPE,{ADBLOCK_TOAST:w,AFF_ID:P,AP_USER_TOGGLE:B,AB_USER_TOGGLE:G,BING_COUNTRY_SET_STRING:y,BING_COUNTRY_SET:M,BLOCKPAGE_WHITELIST:U,BROWSER_TYPE:v,BUILTIN_FF_TOAST_MODE:k,CRYPTO_BLOCKED:W,CRYPTOJACKING_DISABLED:H,DOWNLOADS_BLOCKED:F,DOWNLOADS_SCANNED:x,PAGES_BLOCKED:K,PAGES_SCANNED:Y,PROVIDER_FORCED:q,SECURE_SEARCH_ANNOTATION_ONLY:V,SECURE_SEARCH_REGEXES:j,SECURE_SEARCH_SHOW_ICONS:$,SMA_ANNOTATION_OPTIONS:X,SMA_DISABLED:Q,SMA_USER_TOGGLE:z,SYSTEM_GEO:J,TS_WHITELIST:Z,USE_NATIVE_LOGGER:ee,USER_AGENT:te,WEBBOOST_AUTO_PLAY_NOTIFICATION:se,SS_DEF:ae,CSP_ID_SETTING_NAME:ne}=i.b.SETTINGS;class re{constructor(){this.browserStartSent=!1,this.nativeMsgHandler=null,this.port=null}sendInitialSettings(){const e=new u(this);e.add(v,a.a.browserType.toString(),L,D),e.add(te,navigator.userAgent,L,D),e.send();const t=a.a.cacheStore,s=()=>{if(t.isInit()){const e=t.get(T.c.SOCIAL_MEDIA_ANNOTATION_TOGGLE)||!1,s=t.get(T.c.SOCIAL_MEDIA_ANNOTATION_OPTION)||p.c.NONE,a=new u(this);a.add(`${z}${m.a.getBrowserSuffix()}`,e,L,C),a.add(`${X}${m.a.getBrowserSuffix()}`,s,L,R),a.send()}else setTimeout(s,500)};s()}updateBackgroundGlobals(e){const t=m.a.getBrowserSuffix(),s=e[P];void 0!==s&&(a.a.AFFID=s);const n=e[j];void 0!==n&&(a.a.SECURE_SEARCH_REGEXES=n.trim().split("\n"));const r=e[k];void 0!==r&&(a.a.BUILTIN_FF_TOAST_MODE=r);const i=e[`${Q}${t}`];void 0!==i&&(a.a.SMA_FEATURE_DISABLED=i);const o=e[`${w}${t}`];void 0!==o&&(a.a.AP_FEATURE_ENABLED=Boolean(o));const c=e[ne];void 0!==c&&(a.a.cspId=c)}handleNativeSettings(e){this.updateBackgroundGlobals(e),S.init(e);const t=e[U],s=e[Z];this.cacheWhitelist(t,s);const a=e[q],n=e[J],r=e[M]||y;this.bingSecureSearchSettings(a,n,r)}async getInitialSettings(){const e=m.a.getBrowserSuffix(),t=[{scope:L,name:P},{scope:f,name:j},{scope:L,name:k},{scope:L,name:`${Q}${e}`},{scope:L,name:`${w}${e}`},{scope:L,name:Y},{scope:L,name:K},{scope:L,name:x},{scope:L,name:F},{scope:L,name:W},{scope:f,name:U},{scope:f,name:Z},{scope:L,name:J},{scope:L,name:M},{scope:L,name:q},{scope:L,name:ne}],s=await this.getValues(t);this.handleNativeSettings(s)}async init(e,t){try{if(!e)return;this.port=e,this.nativeMsgHandler=new E,this.nativeMsgHandler.init(this.port,this.processMessage.bind(this)),this.processMessage(t),this.handshakeGreeting(),this.getExtensionStatus({extension_id:a.a.externalExtensions.get("WebBoost")}),this.sendInitialSettings(),await this.getInitialSettings(),this.getNativeCache()}catch(e){a.a.logger.error(e.message)}}autoPlayVideoSite(e,t,s,n){a.a.logger.log(`Autoplay site found in page ${e}`),this.nativeMsgHandler.postMessage({request_type:b.AUTO_PLAY_VIDEO_SITE,payload:{site_domain:e,video_url:t,coordinate_x:s,coordinate_y:n}})}onSettings(e){const t={id:0,request_type:b.ON_SETTINGS_CLICK,payload:{number:114,url:e}};this.nativeMsgHandler.postMessage(t)}handshakeGreeting(){const e=g.a.runtime.getManifest();this.nativeMsgHandler.postMessage({id:0,request_type:b.HANDSHAKE_GREETING,payload:{extn_version:e.version,browser_type:l.c.BROWSER_TYPE,user_agent:navigator.userAgent,extn_id:g.a.runtime.id,setting_subscription_regex:`\\${ae}${m.a.getBrowserSuffix()}`,pps_mode:a.a.PPS_MODE}})}cacheWhitelist(e,t){const{BLOCK_PAGE_WHITELIST:s,TYPOSQUATTING_WHITELIST:n,WHITELIST_FLAG:r}=T.c;if(a.a.cacheStore.get(r))return;const i=void 0!==e?e.split(";"):[],o=void 0!==t?t.split(";"):[];d.addDomainsToWhitelist(i,s),d.addDomainsToWhitelist(o,n),a.a.cacheStore.set(r,!0)}getExtensionStatus({extension_id:e},t){if(!a.a.externalExtensions.isWhiteListed(e))return;const s={request_type:b.GET_EXTENSION_STATUS,payload:{extension_id:e}};this.nativeMsgHandler.postMessage(s,e=>{const{payload:s}=e;"function"==typeof t&&t(s.extension_state)})}logger(e){try{const{browserType:t,extensionType:s,logLevel:n,message:r,processType:i}=e,o={request_type:b.LOG_MSG,id:0,payload:{process_type:i,browser_type:t,extension_type:s,log_level:n,msg:r}};this.nativeMsgHandler.postMessage(o)}catch(t){a.a.logger.setNativeLogging(!1),a.a.logger.error(`Failed to log with details: ${JSON.stringify(e)}. Exception: ${t.message}`)}}handleNativeHandshake(e){a.a.BINARY_VERSION=e.version||"0.0.0.0";const{settings:t}=e;if(!t)return;t[ee]&&a.a.logger.setNativeLogging(!0);const s=t[V],n=t[$];let r=o.a.NONE;s&&n?r=o.a.ONLY_SECURE_SEARCH:n&&(r=o.a.ALL),a.a.cacheStore.set(T.c.SEARCH_ANNOTATION_OPTION,r),a.a.CRYPTOJACKING_FEATURE_DISABLED=t[H]||!1,a.a.AUTO_PLAY_NOTIFICATION_ENABLED=t[se]||!1}SetXYViewport(e,t){const s={X:e,Y:t};a.a.ffViewports=s,this.browserStartSent||(this.executeCommand({command_id:0,args:s}),this.browserStartSent=!0)}genericNativeRequest(e){e.forEach(e=>{if("action"===e.request_type&&e.value)switch(e.name){case"ss_toast":if(a.a.PPS_MODE&&"disabled"!==e.value)a.a.cacheStore.set(T.a.SS_TOAST_ACCEPTED,!0),g.a.tabs.query({active:!0},([e])=>{g.a.browserAction.getBadgeText({tabId:e.id},t=>{if("1"===t)return;g.a.browserAction.setBadgeText({tabId:e.id,text:"1"});const s={...a.a.tabData.get(e.id)||{},actionPanelData:{componentType:l.n.SS_ACCEPTED}};a.a.tabData.set(e.id,s)})});else{const t=JSON.parse(e.value),{enabled:s,post_accept_action:n}=t;if(s){if(a.a.AP_FEATURE_ENABLED){a.a.cacheStore.set(T.c.USER_ACCEPTED_TOAST_ONCE,!0),a.a.cacheStore.set(T.c.IS_SECURE_SEARCH_SET,!0),a.a.cacheStore.set(T.c.AP_USER_TOGGLE,!0),a.a.cacheStore.set(T.c.AB_USER_TOGGLE,!0),a.a.cacheStore.set(T.c.SEARCH_ANNOTATION_OPTION,o.a.ONLY_SECURE_SEARCH),a.a.cacheStore.set(T.a.USER_ACCEPTED_ADBLOCK_TOAST,!0);const e=new u(this);e.add(`${B}${m.a.getBrowserSuffix()}`,!0,f,C),e.add(`${G}${m.a.getBrowserSuffix()}`,!0,f,C),e.send()}switch(n){case"redirect_store":A.focusOrCreateTab(l.j[m.a.browserTypeToString()]);break;case"request_permissions":A.focusOrCreateTab(g.a.runtime.getURL("html/settings.html?tabtype=preferences"))}}else if(a.a.AP_FEATURE_ENABLED){a.a.cacheStore.set(T.c.IS_SECURE_SEARCH_SET,!1),a.a.cacheStore.set(T.c.AP_USER_TOGGLE,!1),a.a.cacheStore.set(T.c.AB_USER_TOGGLE,!1),a.a.cacheStore.set(T.c.SEARCH_ANNOTATION_OPTION,o.a.NONE);const e=new u(this);e.add(`${B}${m.a.getBrowserSuffix()}`,!1,f,C),e.add(`${G}${m.a.getBrowserSuffix()}`,!1,f,C),e.send()}}}})}downloadScanResult(e){if(!a.a.PPS_MODE||e.is_download_safe)return;const t={filePath:e.file_path,fileUrl:e.file_url},s=a.a.cacheStore.get(T.a.DOWNLOAD_SCANNING_QUEUE);s.push(t),a.a.cacheStore.set(T.a.DOWNLOAD_SCANNING_QUEUE,s),S.add(h.DOWNLOADS_BLOCKED),this.triggerDownloadScanningActionPanel(t)}deleteDownloadedFileStatus(e){if(!a.a.PPS_MODE)return;const t={filePath:e.file_path};let s=null,n=null;const r={downloadScanData:t};0===e.error_code?(n=l.n.DOWNLOAD_SCANNING_FILE_DELETED,s=N.h.DOWNLOAD_SCANNING_FILE_DELETED):(n=l.n.DOWNLOAD_SCANNING_FILE_NOT_DELETED,s=N.h.DOWNLOAD_SCANNING_FILE_NOT_DELETED),g.a.tabs.query({active:!0},([e])=>{const t={...a.a.tabData.get(e.id)||{},actionPanelData:{componentType:n,componentData:r}};a.a.tabData.set(e.id,t),g.a.tabs.sendMessage(e.id,{command:N.c.SIDEBAR,payload:{subcommand:s,componentType:n,componentData:r}})})}triggerDownloadScanningActionPanel(e){new Promise(e=>{g.a.tabs.query({active:!0},([t])=>{e(t)})}).then(t=>{const s=l.n.DOWNLOAD_SCANNING_MALICIOUS,n={downloadScanData:e},r=a.a.tabData.get(t.id)||{},i={componentType:s,componentData:n};a.a.tabData.set(t.id,{...r,actionPanelData:i});const o={command:N.c.SIDEBAR,payload:{subcommand:N.h.DOWNLOAD_SCANNING_MALICIOUS,componentType:s,componentData:n}};g.a.tabs.sendMessage(t.id,o,e=>{if(g.a.runtime.lastError&&a.a.logger.log(g.a.runtime.lastError.message),!e){const e=a.a.cacheStore.get(T.a.DOWNLOAD_SCANNING_QUEUE);e.pop(),a.a.cacheStore.set(T.a.DOWNLOAD_SCANNING_QUEUE,e),a.a.logger.log("Failed to get response from content script."),A.focusOrCreateTab(g.a.runtime.getURL(`html/sidebar_action_panel.html?tab-id=${t.id}`))}})})}processInwardMessage(e){const{payload:t,request_type:s}=e,n=Object.keys(I).find(e=>I[e]===s);switch(a.a.logger.log(`Processing message from binary: ${s} (${n})\n${JSON.stringify(t)}`),s){case I.HANDSHAKE_GREETING:this.handleNativeHandshake(t);break;case I.RESTART:g.a.runtime.reload();break;case I.GENERIC_NATIVE_REQUEST:this.genericNativeRequest(t);break;case I.DOWNLOAD_SCAN_RESULT:this.downloadScanResult(t);break;case I.DELETE_FILE_RESULT:this.deleteDownloadedFileStatus(t);break;case I.REDIRECT_URL:{const{redirect_url:e}=t;e&&m.a.isProperWebURL(e)&&A.focusOrCreateTab(e);break}}}processMessage(e){const t=JSON.stringify(e);if("request_type"in e&&"id"in e&&"payload"in e)try{this.processInwardMessage(e)}catch(e){a.a.logger.log(`Native json message may be missing some keys: ${t} + ${e.message} `)}else a.a.logger.log(`Invalid native json message: ${t} `)}setValues(e){this.nativeMsgHandler.postMessage({request_type:b.SET_VALUES,payload:{VERB:"set-setting",PAYLOAD:e}})}getValues(e){const t={request_type:b.GET_VALUES,payload:{VERB:"get-setting",PAYLOAD:e}};return new Promise(e=>{this.nativeMsgHandler.postMessage(t,t=>{const{response:s}=t.payload,a={};if(Array.isArray(s)){for(const e of s)void 0!==e.name&&void 0!==e.value&&(a[e.name]=e.value);e(a)}else e(a)})})}uninit(){this.port&&(this.port.disconnect(),this.port=null)}onDownloadFinished(e,t,s,n){this.nativeMsgHandler.postMessage({request_type:b.ON_DOWNLOAD_FINISHED,id:0,payload:{url:t,file_path:s,referrer:e||"",mime_type:n||"",ext_side_ui:Boolean(a.a.PPS_MODE)}})}executeCommand({command_id:e,args:t}){this.nativeMsgHandler.postMessage({request_type:b.EXECUTE_COMMAND,id:0,payload:{command_id:e,args:t}})}bingSecureSearchSettings(e,t,s){if(!e||!t||!s)return;s.toLowerCase().split(",").includes(t.toLowerCase())&&e===o.c.BING&&(a.a.SECURE_SEARCH_PROVIDER=e)}aggregateData({extension_id:e,payload:t}){void 0!==e&&void 0!==t?this.nativeMsgHandler.postMessage({request_type:b.AGGREGATE_DATA,id:0,payload:{extension_id:e,payload:t}}):a.a.logger.log(`Invalid external extension json message: ${JSON.stringify(t)} `)}installExtension(e,t){this.nativeMsgHandler.postMessage({request_type:b.INSTALL_EXTENSION,id:0,payload:{extension_id:e,redirect_url:t}})}sendTelemetry(e){Object(O.e)(e,O.b.INFO,O.d.TELEMETRY),this.nativeMsgHandler.postMessage({request_type:b.TELEMETRY,id:0,payload:{telemetry_data:e}})}extensionStatusUpdate({extensionId:e}){this.nativeMsgHandler.postMessage({request_type:b.EXTENSION_STATUS_UPDATE,id:0,payload:{extension_id:e}})}cryptojackingHandler(e){this.nativeMsgHandler.postMessage({request_type:b.CRYPTOJACKING_HANDLER,id:0,payload:{type:e}})}getNativeCache(e=""){const t={request_type:b.GET_CACHE_REQUEST,payload:{last_url:e}};this.nativeMsgHandler.postMessage(t,e=>{try{const t=JSON.parse(e.payload);if(!Array.isArray(t)||1!==t.length)return;const s=t[0].a;if(!s||!Array.isArray(s)||0===s.length)return;let n="";for(const e of s)if(n=e.url,delete e.url,!a.a.gtiCache.setReputation(n,e))return;this.getNativeCache(n)}catch(e){a.a.logger.error(`Exception in getNativeCache: ${e.message}`)}})}pushCacheToNative(e){const t={request_type:b.ADD_CACHE_REQUEST,payload:{cache_data:e}};this.nativeMsgHandler.postMessage(t)}shouldShowToast(e){const t={request_type:b.SHOULD_SHOW_TOAST,payload:{}};this.nativeMsgHandler.postMessage(t,({payload:t})=>{t&&e(t)})}showNPSChecklist(e,t){const s={name:e?"EVENT_BROWSER_BlockPageNavigate":"EVENT_BROWSER_SearchPageNavigate",data:{Url:t}};if(l.c.BROWSER_TYPE===l.b.FIREFOX){const{X:e,Y:t}=a.a.ffViewports;s.data.ViewportX=e,s.data.ViewportY=t}l.c.BROWSER_TYPE===l.b.CHROME&&this.nativeMsgHandler.postMessage({request_type:b.MFW_REQUEST,payload:s})}deleteMaliciousFile({filePath:e,fileUrl:t}){const s={file_path:e,file_url:t};this.nativeMsgHandler.postMessage({request_type:b.DOWNLOAD_SCANNING_DELETE_FILE,payload:s})}showPermRequestBalloon(){const e={name:"EVENT_SERVICE_browser_dialog",data:{Browser:l.c.BROWSER_TYPE,dialog_type:1,window_name:""}};this.nativeMsgHandler.postMessage({request_type:b.MFW_REQUEST,payload:e})}}class ie{static createDispatcher(e){let t=null;switch(e){case l.h.NONE:t=null;break;case l.h.LEGACY:t=new c;break;case l.h.V1:t=new re}return t}}const oe={BLOCKED:1};class ce{constructor(){this.blacklist=["wss://*.gasolina.ml/*","*://kissdoujin.com/Content/js/c-hive.js*","wss://*.sen-to-zdrowie.ml/*","*://cookiescript.info/libs/*","*://rocks.io/assets/*","*://coin-have.com/c/*","*://coinnebula.com/lib/*","wss://*.coin-have.com/","ws://digger.cryptobara.com/*","ws://*.webminepool.tk/*","*://*.lewd.ninja/static/m.js*","*://tokyodrift.ga/dropyoulike/a-o/*","*://*.2giga.link/hive/lib/*","*://papoto.com/lib/*","*://load.jsecoin.com/*","ws://*.1q2w3.fun/*","*://*/*plugins/ajcryptominer/assets/*","*://monerominer.rocks/miner.php*","*://minemytraffic.com/*","*://*.monerise.com/core/*","*://*.cookiescript.info/libs/*","ws://hive.tubetitties.com/*","wss://*.freecontent.racing/*","wss://*.hodling.faith/*","ws://gtg02.bestsecurepractice.com/proxy","*://cryptoloot.pro/lib/*","*://lmodr.biz/*","*://*.webminepool.com/lib/base.js","ws://*.sen-to-zdrowie.ml/*","ws://*.morningdigit.com/*","*://mine.nahnoji.cz/*","*://*.minescripts.info/*","*://jsecoin.com/server*","*://coinhive.com/lib*","wss://*.webminepool.tk/*","ws://*.monerise.com/proxy/*","*://kisshentai.net/Content/js/c-hive.js*","*://mataharirama.xyz/*","*://*.coinpirate.cf/*","ws://*.playerassets.info/*","wss://*.1q2w3.fun/*","*://*.1q2w3.fun/*","*://anime.reactor.cc/js/ch/cryptonight.wasm*","*://webmine.cz/miner*","wss://ws.l33tsite.info/*","*://coinhive.com/captcha*","wss://www.mutuza.win/proxy","*://*.morningdigit.com/*","ws://*.host.d-ns.ga/*","*://*.doubleclick5.xyz/*","*://miner.pr0gramm.com/xmr.min.js*","*://*.freecontent.bid/*","ws://lewd.ninja/comics/*","wss://*.monerise.com:9333/proxy/*","*://*.webminepool.com/lib/captcha.js","*://coinerra.com/lib/*","*://*.playerassets.info/*","wss://*.webmine.pro/*","wss://lewd.ninja/comics/*","*://*.doubleclick1.xyz/*","ws://*.freecontent.racing/*","*://*.googleanalytcs.com/*","wss://*.coinnebula.com/proxy*","ws://*.monerise.com:9333/proxy/*","ws://*.freecontent.loan/*","*://party-nngvitbizn.now.sh/*","wss://api.l33tsite.info/*","*://coinlab.biz/lib/coinlab.js*","wss://*.monerise.com/proxy/*","ws://www.mutuza.win/proxy","*://jscdndel.com/content/vidm.min.js*","*://listat.biz/*","*://minecrunch.co/web/*","ws://*.chainblock.science/*","*://baiduccdn1.com/lib/*","*://*.mutuza.win/worker.js","*://*.load.jsecoin.com/*","*://ppoi.org/lib/*","wss://*.chainblock.science/*","wss://*.crypto-loot.com/proxy*","wss://gtg02.bestsecurepractice.com/proxy","wss://*.coinhive.com/proxy*","*://coin-hive.com/captcha*","*://jsccnn.com/content/vidm.min.js*","*://monerominer.rocks/scripts/miner.js*","*://*.jsecoin.com/server*","*://server.jsecoin.com/*","wss://*.coin-hive.com/proxy*","*://*.doubleclick4.xyz/*","*://miner.cryptobara.com/client/*","*://*.rocks.io/assets/*","*://*.ppoi.org/lib/*","*://you.tubetitties.com/worker.js*","wss://*.googleanalytcs.com/*","wss://hive.tubetitties.com/*","*://static.reasedoper.pw/*","*://*.ppoi.org/token/*","ws://*.webmine.pro/*","*://you.tubetitties.com/hash.wasm*","*://*.doubleclick3.xyz/*","*://*.turnsocial.com/m.js","ws://*.hodling.faith/*","wss://*.morningdigit.com/*","*://*.ad-miner.com/lib/*","wss://*.2giga.link/wproxy*","ws://*.googleanalytcs.com/*","*://*.doubleclick6.xyz/*","ws://turnsocial.now.sh/*","*://cdn.cloudcoins.co/javascript/cloudcoins.min.js*","*://joyreactor.cc/ws/ch/*","*://minero.pw/miner.min.js*","*://*.webmine.pro/*","*://punchsub.net/chm.js","wss://mine.nahnoji.cz/*","wss://mine.torrent.pw/*","*://*.mutuza.win/lib/*","*://*.kickass.cd/power2/m.js","ws://*.cpu2cash.link/*","*://*.server.jsecoin.com/*","*://*.mutuza.win/processor.js","wss://turnsocial.now.sh/*","*://kiwifarms.net/js/Jawsh/xmr/xmr.min.js*","*://*.rocks.io/proxy*","*://crypto-loot.com/lib*","*://*.chmproxy.bid/lib/*","ws://*.gasolina.ml/*","*://*.stackpathdns.com/assets/javascript/cr.js","*://*.coinblind.com/lib/*","*://miner.pr0gramm.com/pm.min.js*","*://*.bewhoyouare.gq/*","wss://*.zlx.com.br/proxy*","*://a-o.ninja/apk-AO/kingofthenorth/*","*://ad-miner.com/lib/*","*://*.webminepool.com/api/*","*://*.cpu2cash.link/*","*://*.hemnes.win/*","wss://*.cpu2cash.link/*","ws://*.coinpirate.cf/*","ws://ws.l33tsite.info/*","*://digger.cryptobara.com/client/*","*://kickass.cd/m.js*","ws://*.zlx.com.br/proxy*","*://*.doubleclick2.xyz/*","*://*.amazonaws.com/doubleclick13/*","wss://*.freecontent.loan/*","*://*.host.d-ns.ga/*","*://*.candid.zone/youtube.com/*","ws://api.l33tsite.info/*","*://gtg2.bestsecurepractice.com/lib/*","wss://*.host.d-ns.ga/*","*://coin-hive.com/lib*","ws://mine.nahnoji.cz/*","wss://*.playerassets.info/*","*://*.afminer.com/code/*","wss://*.coinpirate.cf/*","*://cookiescriptcdn.pro/libs/*","*://*.goredirect.party/assets/*","*://*.ZLX.COM.BR/assets/min.js*","*://*.ZLX.COM.BR/assets/playermon.js*","*://p.hemnes.win/lib/*","*://gtg02.bestsecurepractice.com/proxy2/*","*://gtg02.bestsecurepractice.com/meri.js","*://gtg02.bestsecurepractice.com/lv.js","*://gtg02.bestsecurepractice.com/worker.js","*://gtg02.bestsecurepractice.com/processor.js","*://gtg02.bestsecurepractice.com/demo.html","*://*.turnsocial.com/c.wasm*","*://*.turnsocial.com/m.js*","*://cdn.minescripts.info/c/*","*://tokyodrift.ga/dropyoulike/backup/c.wasm*","*://punchsub.net/chm2.js","*://*.kickass.cd/webmr4.js","*://*.kickass.cd/m.js","wss://*.authedmine.com/proxy"]}onBeforeRequest({tabId:e,url:t}){if(!0===a.a.CRYPTOJACKING_FEATURE_DISABLED)return;const s=a.a.tabData.get(e).url,n=_.a.getDomain(s);return d.isDomainInWhitelist(n,T.c.CRYPTO_WHITELIST)?{cancel:!1}:(S.add(h.CRYPTO_BLOCKED),this.notifyCryptoBlock(e,n,t),a.a.logger.log(`Blocked crypto mining script/connection: ${t}`),{cancel:!0})}init(){let e=["websocket","script","xmlhttprequest"];l.b.EDGE===l.c.BROWSER_TYPE&&(this.blacklist=this.blacklist.map(e=>e.replace("wss://","*://").replace("ws://","*://")),e=["script","xmlhttprequest"]),g.a.webRequest.onBeforeRequest.addListener(this.onBeforeRequest.bind(this),{urls:this.blacklist,types:e},["blocking"])}notifyCryptoBlock(e,t,s){const n=s.split("").reverse().join(""),r={command:N.c.TOPBAR,payload:{subcommand:N.j.CRYPTO_BLOCK,domain:t,miner:n}};g.a.tabs.sendMessage(e,r,()=>{g.a.runtime.lastError&&(a.a.logger.log(g.a.runtime.lastError.message),a.a.messageQueue.set(e,r))}),l.b.EDGE===l.c.BROWSER_TYPE&&a.a.messageQueue.set(e,r),a.a.messageDispatcher.cryptojackingHandler(oe.BLOCKED)}addToWhitelist(e,t){const s=_.a.getDomain(e);s&&(d.addDomainsToWhitelist([s],T.c.CRYPTO_WHITELIST),g.a.tabs.reload(t,{bypassCache:!0}))}}class le{init(){g.a.runtime.onMessageExternal.addListener((e,t,s)=>!(void 0===t.id||!a.a.externalExtensions.isWhiteListed(t.id))&&this.processMessage(t.id,e,s));for(const e of a.a.externalExtensions.getExtnIds())this.sendDisconnectNative(e)}processMessage(e,t,s){const{PING:n,ADBLOCK:r}=N.d,{PONG:i}=N.e;let c=!1;if(a.a.logger.log(`Message from: ${e} request: ${JSON.stringify(t)}`),!("request_type"in t&&"payload"in t))return a.a.logger.log(`Invalid external extension json message: ${JSON.stringify(t)} `),c;switch(t.request_type){case n:a.a.logger.log("Got a ping"),s({request_type:i,useNativeLogger:a.a.useNativeLogger}),a.a.messageDispatcher.extensionStatusUpdate({extensionId:e}),c=!0;break;case r:{const{payload:e}=t,{command:n,tabId:r}=e;switch(a.a.cacheStore.set(T.c.SEARCH_ANNOTATION_OPTION,o.a.ONLY_SECURE_SEARCH),n){case N.a.AD_BLOCKED:{const e=a.a.tabData.get(r);if(!e)return;e.adsBlocked+=1,S.add(h.ADS_BLOCKED),a.a.tabData.set(r,e);const t={command:N.c.FLOATING_BALLOON,payload:{subcommand:N.f.UPDATE_AD_COUNT,adsBlocked:e.adsBlocked}};g.a.tabs.sendMessage(r,t,null)}break;case N.a.TRACKER_BLOCKED:{const e=a.a.tabData.get(r);if(!e)return;e.trackersBlocked+=1,S.add(h.TRACKER_BLOCKED),a.a.tabData.set(r,e);const t={command:N.c.FLOATING_BALLOON,payload:{subcommand:N.f.UPDATE_TRACKER_COUNT,trackersBlocked:e.trackersBlocked}};g.a.tabs.sendMessage(r,t,null)}break;case N.a.ADBLOCKER_READY:{const e=a.a.cacheStore.get(T.c.AB_USER_TOGGLE);e&&g.a.tabs.query({},e=>{const t={iframeId:l.f.SIDEBAR,subcommand:N.h.RELOAD};for(const s of e)m.a.isExtensionUrl(s.url)?g.a.tabs.reload(s.id,{}):m.a.isProperWebURL(s.url)&&g.a.tabs.sendMessage(s.id,{details:t})}),s(e),c=!0}}break}}return c}sendDisconnectNative(e){g.a.runtime.sendMessage(e,{request_type:N.d.DISCONNECT_NATIVE,payload:{}})}}var Ee=s(39);class _e{getDomainName(e){let t=null;t=e.startsWith("http")||e.startsWith("www")?e:`https://${e}`;const s=document.createElement("a");return s.setAttribute("href",t),s.hostname.startsWith("www.")?s.hostname.substr(4):s.hostname}init(){g.a.runtime.onMessage.addListener((e,t,s)=>{let n=!1;try{n=this[e.command]&&this[e.command]({request:e,sender:t,cb:s})}catch(e){a.a.logger.error(e.message)}return n})}[N.b.SET_TAB_ACTION_PANEL_DATA]({request:e,sender:t}){a.a.tabData.get(t.tab.id).actionPanelData=e.data}[N.b.IS_WHITELISTED]({request:e,cb:t}){let s=!1;const a=_.a.getDomain(e.url);return d.isDomainInWhitelist(a,T.c.BLOCK_PAGE_WHITELIST)&&(s=!0),t({whitelisted:s}),!0}[N.b.GET_TAB_DATA]({request:e,sender:t,cb:s}){let n=null;return s(n=e.tabId?{...a.a.tabData.get(e.tabId),url:t.url}:a.a.tabData.get(t.tab.id)),!0}[N.b.VIEW_SITE_REPORT]({request:e,sender:t}){const s=g.a.runtime.getURL("html/site_report.html");e.showInNewTab?g.a.tabs.create({url:s},t=>{m.a.setTabBlockPageData(t.id,{url:e.url})}):g.a.tabs.update(t.tab.id,{url:s})}[N.b.ADD_PAGE_SCAN_STAT](){S.add(h.PAGES_SCANNED)}[N.b.AUTO_RUN_VIDEO_SITE]({request:e,sender:t}){g.a.tabs.get(t.tab.id,t=>{const{ffViewports:s}=a.a;let n=-1,r=-1;l.c.BROWSER_TYPE===l.b.FIREFOX&&null!==s&&(n=s.X,r=s.Y);const i=this.getDomainName(t.url);a.a.messageDispatcher.autoPlayVideoSite(i,e.url,n,r)})}[N.b.CACHE_STORE]({request:e,cb:t}){const{action:s,data:n}=e;return a.a.messageDispatcher.cacheStore(s,n,t)}[N.b.EXECUTE_COMMAND]({request:e}){return a.a.messageDispatcher.executeCommand(e.commandId,e.params)}[N.b.FOCUS_OR_CREATE_TAB]({request:e}){A.focusOrCreateTab(e.url)}[N.b.REMOVE_TAB]({sender:e}){g.a.tabs.remove(e.tab.id,()=>{})}[N.b.GET_BK_GLOBALS]({cb:e}){e(a.a)}[N.b.GET_CLICK_EVENT_TIME]({sender:e,cb:t}){t(a.a.tabIdToLastClickTime.get(e.tab.id))}[N.b.GET_COSMETIC_FILTERS]({request:e,sender:t,cb:s}){return a.a.adblockManager.onRuntimeMessage(e,t,s),!0}[N.b.GET_EXTENSION_STATUS]({request:e,cb:t}){return a.a.messageDispatcher.getExtensionStatus(e,t),!0}[N.b.GET_VALUES]({request:e,cb:t}){return a.a.messageDispatcher.getValues(e.getList).then(e=>t(e)),!0}[N.b.GTI_REQUEST]({request:e,cb:t}){const{url:s,isSecureSearch:n,requestData:r,referer:i}=e;return a.a.messageDispatcher.makeGTIRequest(s,n,r,i,t)}[N.b.GET_TYPOSQUATTING_DATA]({request:e,cb:t}){t((a.a.cacheStore.get(T.a.CACHE_TYPOQUATTING)||{})[e.domain]||null)}[N.b.INSTALL_EXTENSION]({request:e}){a.a.messageDispatcher.installExtension(e.extension_id,e.redirect_url)}[N.b.IS_FRAME_BLOCKED]({request:e,cb:t}){return a.a.messageDispatcher.isFrameBlocked(e.url,t)}[N.b.IS_PAGE_BLOCKED]({request:e,cb:t}){return a.a.messageDispatcher.isPageBlocked(e.url,t)}[N.b.LOGGER]({request:e}){const{message:t,logType:s}=e,{CONTENT:n}=O.d;s===O.b.ERROR&&a.a.logger.error(t,n),s===O.b.INFO&&a.a.logger.log(t,n)}[N.b.SAVE_CLICK_EVENT_TIME]({request:e,sender:t}){a.a.tabIdToLastClickTime.set(t.tab.id,e.last_event)}[N.b.SEND_TELEMETRY]({request:e}){return a.a.messageDispatcher.sendTelemetry(e.telemetry)}[N.b.SET_VIEWPORT]({request:e}){const{x:t,y:s}=e;a.a.messageDispatcher.SetXYViewport(t,s)}[N.b.SHOW_OPTIONS]({request:e}){a.a.messageDispatcher.onSettings(e.url)}[N.b.UPDATE_TOP_FRAME]({sender:e,cb:t}){return a.a.messageDispatcher.updateTopFrame(e.tab.id,t),!0}[N.b.UPDATE_BROWSER_ACTION]({request:e,sender:t}){a.a.messageDispatcher.updateBrowserAction(e.details,e.allTabs,t.tab.id)}[N.b.WHITELIST]({request:e,sender:t,cb:s}){const{action:n,type:r,data:i}=e,o=t.tab?t.tab.id:null;return i.tabId=o,a.a.messageDispatcher.whitelist(n,r,i,s)}[N.b.GET_POPUP_DATA]({sender:e,cb:t}){return a.a.messageDispatcher.getPopupData(e.tab.id,e.tab.url,t),!0}[N.b.GET_SETTINGS_DATA]({cb:e}){return a.a.messageDispatcher.getSettingsData(e),!0}[N.b.SEARCH_ANNOTATION]({request:e,cb:t}){const{action:s,data:n}=e;return a.a.messageDispatcher.searchAnnotation(s,n,t)}[N.b.SOCIAL_MEDIA_ANNOTATION]({request:e,cb:t}){const{action:s,data:n}=e;return a.a.messageDispatcher.socialMediaAnnotation(s,n,t)}[N.b.RESET_SETTINGS](){return a.a.messageDispatcher.resetSettings(),!0}[N.b.UPDATE_ENGINE_STATS]({request:e}){for(const{name:t,selectors:s}of Ee.a.searchengines)if(t===e.engine.name&&s.length===e.engine.selectors.length){for(let t=0;t<s.length;t++)s[t].matched+=e.engine.selectors[t].matched;break}}[N.b.CONTENT_HANDLER]({sender:e,request:t}){let s=!1;t.message&&t.message.iframeMessageWait&&(s=!0),g.a.tabs.sendMessage(e.tab.id,t.message,n=>{s&&void 0===n&&g.a.tabs.sendMessage(e.tab.id,{command:N.c.RETRY_IFRAME,payload:t.message},()=>{g.a.runtime.lastError&&a.a.logger.log(g.a.runtime.lastError.message)}),g.a.runtime.lastError&&a.a.logger.log(g.a.runtime.lastError.message)})}[N.b.SHOULD_SHOW_TOAST]({cb:e}){return a.a.messageDispatcher.shouldShowToast(e),!0}[N.b.CLOSE_TOAST]({sender:e,request:t}){const{userConfirmation:s}=t;g.a.tabs.query({},t=>{for(const n of t){const t={command:N.c.TOAST,payload:{subcommand:N.i.CLOSE,userConfirmation:e.tab.id===n.id&&s}};g.a.tabs.sendMessage(n.id,t,()=>{g.a.runtime.lastError&&a.a.logger.log(g.a.runtime.lastError.message)})}}),a.a.messageDispatcher.closeToast(s)}[N.b.SHOW_NPS_CHECKLIST]({request:{fromBlockPage:e=!1,location:t}}){a.a.messageDispatcher.showNPSChecklist(e,t)}[N.b.ADD_ADBLOCK_WHITELIST]({sender:e}){const t=a.a.tabData.get(e.tab.id),{adblockWhitelist:s,url:n}=t,r=new URL(n).hostname;s.includes(r)||s.push(r),g.a.tabs.reload(e.tab.id,{},()=>{g.a.runtime.lastError&&a.a.logger.log(g.a.runtime.lastError.message)})}[N.b.REMOVE_ADBLOCK_WHITELIST]({sender:e}){const t=a.a.tabData.get(e.tab.id),{adblockWhitelist:s,url:n}=t,r=new URL(n).hostname,i=s.indexOf(r);-1!==i&&s.splice(i,1),g.a.tabs.reload(e.tab.id,{},()=>{g.a.runtime.lastError&&a.a.logger.log(g.a.runtime.lastError.message)})}[N.b.TOGGLE_ADBLOCK_ENGINE]({request:e}){e.enableAdblockEngine?a.a.adblockManager.enableAdBlocking():a.a.adblockManager.disableAdblocking()}[N.b.RELOAD_SIDEBAR_PANEL]({sender:e}){g.a.tabs.query({},t=>{const s={iframeId:l.f.SIDEBAR,subcommand:N.h.RELOAD};for(const a of t){const t=e.tab.id===a.id;m.a.isExtensionUrl(a.url)&&!t?g.a.tabs.reload(a.id,{}):m.a.isProperWebURL(a.url)&&g.a.tabs.sendMessage(a.id,{details:s})}})}[N.b.DOWNLOAD_SCANNING_DELETE_FILE]({request:e}){a.a.messageDispatcher.deleteMaliciousFile(e.payload)}[N.b.TRIGGER_NEXT_EVENT_FOR_DOWNLOAD_SCANNING](){const e=a.a.cacheStore.get(T.a.DOWNLOAD_SCANNING_QUEUE);if(!e.length)return;const t=e[e.length-1];a.a.messageDispatcher.triggerDownloadScanningActionPanel(t)}[N.b.REMOVE_FROM_DOWNLOAD_SCAN_QUEUE](){const e=a.a.cacheStore.get(T.a.DOWNLOAD_SCANNING_QUEUE);e.pop(),a.a.cacheStore.set(T.a.DOWNLOAD_SCANNING_QUEUE,e)}[N.b.SHOW_PERM_REQUEST_BALLOON](){a.a.messageDispatcher.showPermRequestBalloon()}}class de{onChanged({state:e,id:t}){if(!e)return;const{previous:s,current:n}=e;"in_progress"===s&&"complete"===n&&g.a.downloads.search({id:t},e=>{e.forEach(e=>{a.a.messageDispatcher.onDownloadFinished(e)})})}init(){l.c.BROWSER_TYPE!==l.b.EDGE&&g.a.downloads.onChanged.addListener(this.onChanged)}}var ue=s(3);class Te{static disable(e){null!==g.a.browserAction&&g.a.browserAction.disable(e)}static setTitle(e){null!==g.a.browserAction&&g.a.browserAction.setTitle({title:e})}static setIcon(e,t){if(!g.a.browserAction)return;let s={16:e.size16,32:e.size32};l.c.BROWSER_TYPE===l.b.EDGE&&(s={20:e.size20,40:e.size40}),t?g.a.browserAction.setIcon({path:s,tabId:t},()=>{g.a.runtime.lastError&&ue.a.logger(g.a.runtime.lastError.message,O.b.ERROR)}):g.a.browserAction.setIcon({path:s})}}const he=Ee.a.searchengines.filter(e=>[o.c.GOOGLE,o.c.YAHOO,o.c.BING,o.c.YANDEX].includes(e.sourcetype));function Se(e){let t={},s=!0;if(l.b.FIREFOX===l.c.BROWSER_TYPE&&(null!==a.a.ffViewports?t=a.a.ffViewports:a.a.logger.log("Warning: raising new tab without firefox viewports")),l.b.CHROME===l.c.BROWSER_TYPE){const{pendingUrl:t}=e,a=["https://chrome.google.com/webstore/detail/mcafee%C2%AE-secure-search/enppghjcblldgigemljohkgpcompnjgh"];t&&(m.a.isExtensionUrl(t)||a.includes(t))&&(s=!1)}s&&a.a.messageDispatcher.executeCommand({command_id:l.e.RAISE_NEW_TAB_EVENT,args:t})}function ge({tabId:e}){a.a.SMA_FEATURE_DISABLED||g.a.browserAction.getBadgeText({tabId:e},t=>{const{SMA_NOTIFICATION_TRIGGER_STATE:s}=T.c,{SS_TOAST_ACCEPTED:n}=T.a,{NONE:r}=p.a,i=a.a.cacheStore.get(s)||r,o=!!a.a.PPS_MODE&&a.a.cacheStore.get(n);"1"!==t||i===p.a.BADGE||o||g.a.browserAction.setBadgeText({tabId:e,text:""})})}function Ae(e,{status:t},s){if("loading"===t){delete a.a.tabFrames[e];const t=a.a.tabData.get(e)||{adblockWhitelist:[],adblockDisabled:!1,adsBlocked:0,trackersBlocked:0},n={...t,url:s.url,adblockDisabled:!1};if(a.a.AP_FEATURE_ENABLED){const{adblockWhitelist:e}=t;(Array.isArray(e)&&e.includes(new URL(s.url).hostname)||m.a.isSearchEngineResultPage(s.url,he))&&(n.adblockDisabled=!0)}a.a.tabData.set(e,n)}else if("complete"===t){const t=a.a.messageQueue.get(e);if(void 0!==t&&(g.a.tabs.sendMessage(e,t),a.a.messageQueue.delete(e)),s.url){const t=a.a.lastUrl;if(null!==t&&t===s.url||(a.a.lastUrl=s.url),m.a.isHackerSafeUrl(s.url)){const t=m.a.toImagePaths("hackersafe");Te.setIcon(t,e,s.url)}else if(m.a.isProperWebURL(s.url)){const t=a.a.messageDispatcher.toBrowserActionImages(s.url);null!==t&&Te.setIcon(t,e,s.url)}else{const t=m.a.toImagePaths("disabled");Te.setIcon(t,e,s.url)}}}}function Oe(e){try{delete a.a.tabFrames[e]}catch(e){a.a.logger.log(e.message)}a.a.tabData.delete(e)}class me{init(){g.a.tabs.onCreated.addListener(Se),g.a.tabs.onUpdated.addListener(Ae),g.a.tabs.onActivated.addListener(ge),g.a.tabs.onRemoved.addListener(Oe)}}class pe{constructor(){this.onBeforeSendHeaders=this.onBeforeSendHeaders.bind(this),this.onNavigateComplete=this.onNavigateComplete.bind(this)}onBeforeSendHeaders(e){let t;if(e.requestHeaders)for(let s=0;s<e.requestHeaders.length;s++){const a=e.requestHeaders[s];if("Referer"===a.name){t=a.value;break}}a.a.messageDispatcher.onBeforeSendHeaders(e.url,e.tabId,e.frameId,t)}onNavigateComplete({url:e}){a.a.messageDispatcher.onNavigate(e)}init(){const e=["http://*/*","https://*/*","ftp://*/*"];g.a.webRequest.onBeforeSendHeaders.addListener(this.onBeforeSendHeaders,{urls:e,types:["main_frame","sub_frame"]},["requestHeaders","extraHeaders"]),g.a.webRequest.onCompleted.addListener(this.onNavigateComplete,{urls:e,types:["main_frame"]})}}var Ne=s(4);class Ie{static sendNavigate(e){const t={};t.url=e,t.browser=m.a.browserTypeToString(),t._event_name=Ne.d.BROWSER_NAVIGATE,a.a.messageDispatcher.sendTelemetry(JSON.stringify(t))}static sendTyposquatting(){const e={};e.name=Ne.f.TYPOSQUATTING,e.interaction_type=Ne.g.IMPRESSION,e.browser=m.a.browserTypeToString(),e._event_name=Ne.d.TYPOSQUATTING,a.a.messageDispatcher.sendTelemetry(JSON.stringify(e))}static sendBlockPage(e,t,s,n){const r=Ne.c.getBlockPage(e,t,s,n);a.a.messageDispatcher.sendTelemetry(JSON.stringify(r))}static sendBrowserActionClicked(e="0"){const t=Ne.c.getBrowserActionClicked(e);a.a.messageDispatcher.sendTelemetry(JSON.stringify(t))}static sendSideBarPanelAction(e){const t=Ne.c.getSideBarPanelAction(e);a.a.messageDispatcher.sendTelemetry(JSON.stringify(t))}}class be{browserAction({id:e,url:t}){g.a.browserAction.getBadgeText({tabId:e},async s=>{if(a.a.SMA_FEATURE_DISABLED)return;const{SMA_NOTIFICATION_TRIGGER_STATE:n}=T.c,{SS_TOAST_ACCEPTED:r}=T.a,{NONE:i,SIDEBAR:o,BADGE:c}=p.a,E=a.a.cacheStore.get(n)||i,_=!!a.a.PPS_MODE&&a.a.cacheStore.get(r);let d=N.h.MAIN,u=null,h=null;const S=a.a.tabData.get(e)||{},O=S.actionPanelData||{},m=O?O.componentType:null,{SS_ACCEPTED:I}=l.n,b=E===c&&"1"===s&&m!==I;if(a.a.PPS_MODE)if(_&&"1"===s&&m===I){d=N.h.SS_ACCEPTED,u=l.n.SS_ACCEPTED,h={};const t={componentType:l.n.SS_ACCEPTED},s={...S,actionPanelData:t};a.a.tabData.set(e,s)}else if(b)Ie.sendSideBarPanelAction(Ne.g.SIDEBAR_PANEL.SMA),Ie.sendBrowserActionClicked("1"),d=N.h.SMA,a.a.cacheStore.set(n,o);else{d=N.h.SITE_REPORT;const e=(await be.makeGTICall(t,!1,[t],void 0)).annotationMap[t],s=e?{...e}:{},a={url:t,annotationItem:s};u=l.n.SITE_REPORT,h={siteReportData:a}}else b?(Ie.sendSideBarPanelAction(Ne.g.SIDEBAR_PANEL.SMA),Ie.sendBrowserActionClicked("1"),d=N.h.SMA,a.a.cacheStore.set(n,o)):(Ie.sendSideBarPanelAction(Ne.g.SIDEBAR_PANEL.MAIN),Ie.sendBrowserActionClicked());const D={command:N.c.SIDEBAR,payload:{subcommand:d,componentType:u,componentData:h}};g.a.tabs.sendMessage(e,D,n=>{if(g.a.runtime.lastError&&a.a.logger.log(g.a.runtime.lastError.message),!n){a.a.logger.log("Failed to get response from content script.");let n=E===c&&"1"===s?"html/sidebar_sma.html":"html/sidebar_main.html";if(a.a.PPS_MODE&&_&&"1"===s&&(n=`html/sidebar_action_panel.html?tab-id=${e}`,g.a.browserAction.setBadgeText({tabId:e,text:""})),t.includes("html/sidebar_main.html")||t.includes(g.a.runtime.getURL("html/sidebar_action_panel.html")))return;A.focusOrCreateTab(g.a.runtime.getURL(n))}})})}init(){g.a.browserAction.onClicked.addListener(this.browserAction)}static makeGTICall(e,t,s,n){return new Promise(r=>{a.a.messageDispatcher.makeGTIRequest(e,t,s,n,e=>r(e))})}}class De{constructor(){this.listeners=[]}getListenersWhenDisabled(){return 0===this.listeners.length&&this.listeners.push.apply(this.listeners,[new me,new _e]),this.listeners}getListeners(){return 0===this.listeners.length&&(this.listeners.push.apply(this.listeners,[new _e,new me,new pe,new de,new be,new le]),a.a.CRYPTOJACKING_FEATURE_DISABLED||this.listeners.push(new ce)),this.listeners}}class Re{static generateWASM(){return a.a.wasm?null:(WebAssembly.instantiateStreaming=null,WebAssembly.compileStreaming=null,s.e(31).then(s.bind(null,107)))}}class Ce{static unregister(){Ce.port.onDisconnect.removeListener(Ce.onDisconnectHandler),Ce.port.onMessage.removeListener(Ce.onMessageHandler)}static onMessageHandler(e){Ce.unregister(),Array.isArray(e)?Ce.callback(Ce.port,l.h.LEGACY,e):Ce.callback(Ce.port,l.h.V1,e),Ce.unregister()}static onDisconnectHandler(){g.a.runtime.lastError&&a.a.logger.log(g.a.runtime.lastError.message),Ce.unregister(),Ce.callback(null,l.h.NONE,null)}static connect(e){return Ce.callback=e,Ce.port=g.a.runtime.connectNative("siteadvisor.mcafee.chrome.extension"),null===Ce.port?(a.a.logger.error("Failed to connect to Native Host"),!1):(Ce.port.onMessage.addListener(Ce.onMessageHandler),Ce.port.onDisconnect.addListener(Ce.onDisconnectHandler),!0)}}Ce.port=null,Ce.callback=null;var Le=s(18);class fe{constructor(){this.annotationMap={}}}class we{constructor(){this._response=new fe,this._gtiResponse=null,this._requestdata=null,this._cachedItems=[]}init(e,t){this._gtiResponse=e,this._requestdata=t}addCachedItem(e){this._cachedItems.push(e)}buildLinkInfo(e,t,s){this._response.annotationMap[e]=Object.assign({fromCache:s},t)}prepareFromCacheResponse(){const e=this._cachedItems.length;for(let t=0;t<e;++t){const e=this._cachedItems[t];this.buildLinkInfo(e.uri,e.value.value,e.fromCache)}}prepareFromGTIResponse(e){if(0===this._gtiResponse.length)return;const t=""===this._gtiResponse[0]?this._gtiResponse[1]:this._gtiResponse[0];if(0!==Object.keys(t).length||t.constructor!==Object){for(let e=0;e<t.a.length;++e){const s=t.a[e];if(void 0!==s.aflag&&s.aflag===Le.b.globalSafeModeFlag)continue;const n=this._requestdata[e];s.url=n,a.a.gtiCache.setReputation(n,s),this.buildLinkInfo(n,s)}if(e){const e=[t];a.a.messageDispatcher.pushCacheToNative(JSON.stringify(e))}}}prepareResponse(e,t,s,a){this.prepareFromGTIResponse(a),this.prepareFromCacheResponse(),s(this._response)}}var Pe=s(19);class Be{constructor(){this._builder=new we,this._fncallback=null,this._issecureSearch=!1,this._url=null,this._http=new Pe.a}prepareBody(e,t,s){const n=new Le.a(t);let r=0;for(let t=0;t<e.length;++t){const o=e[t],c=a.a.gtiCache.getReputation(o);if(null===c.cache_entry){n.q[r]=new Le.c,n.q[r].op="url",n.q[r].url=o;const e={};e.uag=a.a.userAgentInBase64,"string"==typeof s&&(e.refurl=window.btoa(s)),a.a.cspId!==i.b.SETTINGS.CSP_ID_DEFAULT_VALUE&&(e.cspid=a.a.cspId),n.q[r].qmd=e,++r}else this._builder.addCachedItem({uri:o,value:c.cache_entry,fromCache:!0}),e.splice(t,1),--t}return{body:n}}request(e,t){const s={method:"POST",url:Le.b.serverURL,body:JSON.stringify(t),headers:e};return this.makeGTIRequest(s)}makeGTIRequest(e){return this._http.sendHttpRequest(e).then(e=>e.json())}generateRequestId(){return Math.floor(99999e3*Math.random())+1e3}async generateHeaders(e){const t={};t["Content-Type"]=Le.b.contentType;const s=await a.a.wasm.wasm_gti_hmac_sha1(JSON.stringify(e));return t.xdate=(new Date).toUTCString(),t.Authorization=`GTI ${Le.b.gtiId}:${s}`,t}toResponse(e,t,s){this._builder.init(e,t),this._builder.prepareResponse(this._url,this._issecureSearch,this._fncallback,s)}async post(e,t,s,n,r){try{this._issecureSearch=t,this._fncallback=r,this._url=e;const i=s.slice(),o=this.generateRequestId(),c=this.prepareBody(s,o,n),l=[];if(c.body.q.length>0)try{const e=await this.generateHeaders(c.body),t=await this.request(e,c.body);this.toResponse(t,s,!0)}catch(e){this._fncallback(null),a.a.logger.error(e)}else this.toResponse(l,i,!1)}catch(e){a.a.logger.error(e.message)}}}class Ge{constructor(){this.whitelistStore=T.c.TYPOSQUATTING_WHITELIST,this.cacheTyposquatting=T.a.CACHE_TYPOQUATTING,this.baseUrl="https://mip.api.mcafeewebadvisor.com/v1/typosquatting?",this.locale="en_us",this.http=new Pe.a}sendAndReceiveRequest({url:e,headers:t}){return new Promise((s,a)=>{const n=setTimeout(()=>{a(new Error("Typosquatting timed out"))},3e3);this.http.sendHttpRequest({method:"GET",url:e,headers:t}).then(e=>{clearTimeout(n),s(e.json())},e=>{clearTimeout(n),a(new Error(`HttpService failure: ${e}`))})})}parseUrlToObject(e){const t={};return e.split("&").forEach(e=>{const[s,a]=e.split("=");"bdomain"===s&&(t.typoDomain=a),"bname"===s&&(t.brandName=unescape(a).replace(/\+/g," ")),"xp"===s&&(t.experience="search"===a?3:1),"targeturl"===s&&(t.typoRedirect=unescape(a.replace(/\0/g,"")))}),t}async processResponse({url:e},t,s,n){const r=a.a.cacheStore.get(this.cacheTyposquatting)||{};if(""===e)return r[t]={experience:-1},a.a.cacheStore.set(this.cacheTyposquatting,r),void n(null);if(!m.a.isHackerSafeUrl(e))return void n(null);const i=_.a.getParam(e,"payload");try{const e=await a.a.wasm.wasm_typosquat_decrypt(decodeURIComponent(i)),o=this.parseUrlToObject(e);o.originalUrl=s,r[t]=o,a.a.cacheStore.set(this.cacheTyposquatting,r),n(t)}catch(e){a.a.logger.error(e)}}async lookupTypoSquatFromServer(e,t){const s=_.a.getDomain(e);try{const n=(a.a.cacheStore.get(this.cacheTyposquatting)||{})[s];if(n)return void t(-1===n.experience?null:s);const r=`domain=${s}&locale=${this.locale}`,i=`${this.baseUrl}${r}`,o=await a.a.wasm.wasm_typosquat_sha256(r),c=await this.sendAndReceiveRequest({url:i,headers:{"Content-Checksum":o}});this.processResponse(c,s,e,t)}catch(e){a.a.logger.error(e)}}isInWhitelist(e){return d.isDomainInWhitelist(e,this.whitelistStore)}}class ye{constructor(e){this.dispatcher=e,this.settings=[]}add(e,t){this.settings.push({name:e,scope:t})}send(){return this.dispatcher?this.dispatcher.getValues(this.settings):new Promise(e=>e(null))}}const{STRING:Me}=i.b.SETTINGS_TYPE,{USER:Ue}=i.b.SCOPE,{BLOCKPAGE_WHITELIST:ve}=i.b.SETTINGS;class ke{static getBlockPage(e){return new Promise(t=>{if(!a.a.SMA_FEATURE_DISABLED)return void t();const s=new ye(e);s.add(ve,Ue),s.send().then(e=>{if(null===e)return void t();const s=e[ve],n=void 0!==s&&s.length>0?s.split(";"):[];a.a.cacheStore.set(T.c.BLOCK_PAGE_WHITELIST,n),t()})})}static setBlockPage(e){if(!a.a.SMA_FEATURE_DISABLED)return;const t=new u(e),s=d.getDomainsFromWhitelist(T.c.BLOCK_PAGE_WHITELIST).join(";");t.add(ve,s,Ue,Me),t.send()}}var We=s(22);const{INT:He,STRING:Fe,BOOL:xe}=i.b.SETTINGS_TYPE,{SYSTEM:Ke,USER:Ye}=i.b.SCOPE,{CH:qe,FF:Ve,IE:je}=i.b.BROWSER_SUFFIX,{SECURE_SEARCH_TOAST_STAMP:$e,SECURE_SEARCH_SHOW_ICONS:Xe,SECURE_SEARCH_ANNOTATION_ONLY:Qe,TS_WHITELIST:ze,CHECKLIST_START_INGORE_DATE_AV:Je,CHECKLIST_START_IGNORE_DATE_FW:Ze,CHECKLIST_IGNORE_DURACTION:et,CHECKLIST_GRACE_PERIOD_AV:tt,CHECKLIST_GRACE_PERIOD_FW:st,CHECKLIST_GRACE_PERIOD_DURATION:at,SMA_ANNOTATION_OPTIONS:nt,SMA_USER_TOGGLE:rt,SECURE_SEARCH_CHOICE:it,ADBLOCK_REENABLE_TOAST:ot}=i.b.SETTINGS;class ct{constructor(e){this.nativeDispatcher=e}autoPlayVideoSite(e,t,s,a){this.nativeDispatcher&&this.nativeDispatcher.autoPlayVideoSite(e,t,s,a)}setNativeValuesByStoreVariable(e,t){if(e===T.c.AP_USER_TOGGLE||e===T.c.AB_USER_TOGGLE){const s=i.b.SETTINGS[e],a=new u(this.nativeDispatcher);a.add(`${s}${m.a.getBrowserSuffix()}`,t,Ye,xe),a.send()}}cacheStore(e,t,s){const{SET:n,GET:r,CLEAR:i}=T.b;if(e===r){for(const e in t)t[e]=a.a.cacheStore.get(e);return s(t),!0}if(e===n&&t)for(const e in t)this.setNativeValuesByStoreVariable(e,t[e]),a.a.cacheStore.set(e,t[e]);if(e===i)for(const e in t)a.a.cacheStore.clear(e);return s(!0),!1}cryptojackingHandler(e){this.nativeDispatcher&&this.nativeDispatcher.cryptojackingHandler(e)}executeCommand(e,t){this.nativeDispatcher&&this.nativeDispatcher.executeCommand(e,t)}extensionStatusUpdate({extensionId:e}){this.nativeDispatcher&&this.nativeDispatcher.executeCommand({extensionId:e})}getPopupData(e,t,s){const n={};n.stats=S.read(),n.url=t,n.tabData=a.a.tabData.get(e),n.tabId=e,n.AP_FEATURE_ENABLED=a.a.AP_FEATURE_ENABLED,n.PPS_MODE=a.a.PPS_MODE,n.cacheStore=a.a.cacheStore,s(n)}getSettingsData(e){const{cacheStore:t}=a.a,s={},n=d.getDomainsFromWhitelist(T.c.BLOCK_PAGE_WHITELIST),r=t.get(T.c.SEARCH_ANNOTATION_OPTION)||o.a.ONLY_SECURE_SEARCH,i=t.get(T.c.SOCIAL_MEDIA_ANNOTATION_OPTION)||p.c.NONE,c=t.get(T.c.SOCIAL_MEDIA_ANNOTATION_TOGGLE)||!1;s.whitelistedLinks=n,s.searchAnnotationOption=r,s.sma={socialMediaOption:i,socialMediaToggle:c},s.stats=S.read(),e(s)}makeGTIRequest(e,t,s,a,n){return(new Be).post(e,t,s,a,n),!0}handleTyposquatting(e,t){if(a.a.PPS_MODE)return void t(!1,null);const s=new Ge,n=_.a.getDomain(e);if(s.isInWhitelist(n))t(!0,null).catch(e=>{a.a.logger.error(`Error: ${e}`)});else try{s.lookupTypoSquatFromServer(e,e=>{t(!1,e)}).catch(e=>{a.a.logger.error(`${e}`)})}catch(e){a.a.logger.error(`Error: ${e}`)}}isFrameBlocked(e,t){return ke.getBlockPage(this.nativeDispatcher).then(()=>{const s=_.a.getDomain(e);if(d.isDomainInWhitelist(s,T.c.BLOCK_PAGE_WHITELIST))return void t({isBlocked:!1,redirectURI:e});const n=a.a.gtiCache.getReputation(e);if(!n||!n.cache_entry)return void t({isBlocked:!1,redirectURI:e});const r=this.toBlockState(n.cache_entry.value);r.color!==l.d.RED&&r.color!==l.d.YELLOW||t({isBlocked:!0,redirectURI:e})}),!0}isPageBlocked(e,t){return ke.getBlockPage(this.nativeDispatcher).then(()=>{const s=_.a.getDomain(e);if(d.isDomainInWhitelist(s,T.c.BLOCK_PAGE_WHITELIST))return void t({url:null,image:null,blockState:null,color:null});const n=a.a.gtiCache.getReputation(e);if(!n||!n.cache_entry)return void t({url:null,image:null,blockState:null,color:null});const r=this.toBlockState(n.cache_entry.value),i=this.toBlockPageUrl(r.state,r.color,e);t({url:i.url,image:i.actionImage,blockState:r.state,color:r.color})}),!0}installExtension(e,t){this.nativeDispatcher&&this.nativeDispatcher.installExtension(e,t)}logger(e){this.nativeDispatcher&&this.nativeDispatcher.logger(e)}onBeforeSendHeaders(e,t,s,n){this.toUrlReputation(e,t,s,n,({color:n,fromCache:r=!1,statusOfBlocking:i,typoDomain:o=null,whitelisted:c,categories:E=[]}={})=>{const _=[...l.a];if(a.a.tabFrames[t]||(a.a.tabFrames[t]={subFrames:new Set}),s<=0){let s=a.a.tabData.get(t)||{adblockWhitelist:[],adblockDisabled:!1,adsBlocked:0,trackersBlocked:0};if(a.a.tabData.set(t,{...s,adsBlocked:0,trackersBlocked:0,actionPanelData:{}}),!c&&_.includes(i))if(S.add(h.PAGES_BLOCKED),i===l.a.TYPOSQUATTING&&Ie.sendTyposquatting(),a.a.PPS_MODE){if(i===l.a.RED||i===l.a.YELLOW||i===l.a.PHISHING){s=a.a.tabData.get(t)||{url:e};const n={url:e,blockState:i,categories:E,isFromSearchPage:!1},o={componentType:l.n.BLOCK_PAGE,componentData:{blockPageData:n}},c={...s,actionPanelData:o};a.a.tabData.set(t,c);const _="html/sidebar_action_panel.html";if(e.includes(_))return;const d=`cache=${r}`,u=`${g.a.runtime.getURL(_)}?${d}`;g.a.tabs.update(t,{url:u})}}else{Ie.sendBlockPage(n,Ne.g.IMPRESSION,Ne.h.TOP);const s=null!==o?o:e,a=this.toBlockPageUrl(i,n,s,r);m.a.setTabBlockPageData(t,{bState:i,url:s}),g.a.tabs.update(t,{url:a.url})}Te.setIcon(this.resolveBrowserActionImages(n),t)}else{if(c)return;if(_.includes(i)){a.a.tabFrames[t].subFrames.add({url:e,frameId:s});const{IFRAMES_BLOCKED:r,PAGES_BLOCKED:i,PAGES_SCANNED:o}=h,c=l.b.EDGE===l.c.BROWSER_TYPE?r:i;if(S.add(c),S.add(o),a.a.PPS_MODE){const e={iframeBlockedUrls:[...a.a.tabFrames[t].subFrames]};return void g.a.tabs.sendMessage(t,{command:N.c.SIDEBAR,payload:{subcommand:N.h.IFRAME_BLOCK,componentType:l.n.IFRAME_BLOCK,componentData:{iframeBlockData:e}}})}Ie.sendBlockPage(n,Ne.g.IMPRESSION,Ne.h.FRAME),g.a.tabs.sendMessage(t,{command:N.c.TOPBAR,payload:{url:e,subcommand:N.j.IFRAME_BLOCK,frameId:s}})}}})}onNavigate(e){S.add(h.PAGES_SCANNED),Ie.sendNavigate(e)}onDownloadFinished(e){this.nativeDispatcher&&(this.nativeDispatcher.onDownloadFinished(e.referrer,e.url,e.filename,e.mime),a.a.PPS_MODE&&g.a.tabs.query({active:!0},([e])=>{g.a.tabs.sendMessage(e.id,{command:N.c.FLOATING_BALLOON,payload:{subcommand:N.f.UPDATE_DOWNLOAD_SCAN_COUNT}})}),S.add(h.DOWNLOADS_SCANNED))}onSettings(e){this.nativeDispatcher&&this.nativeDispatcher.onSettings(e)}pushCacheToNative(e){this.nativeDispatcher&&this.nativeDispatcher.pushCacheToNative(e)}resetSettings(){a.a.cacheStore.clear(T.c.SMA_LAST_SHOWN),a.a.cacheStore.clear(T.c.SMA_NOTIFICATION_TRIGGER_STATE);const e=new u(this.nativeDispatcher);e.add(`${$e}${qe}`,0,Ye,He),e.add(`${$e}${Ve}`,0,Ye,He),e.add(`${$e}${je}`,0,Ye,He),e.add(ze,"",Ye,Fe),e.add(Je,"",Ke,Fe),e.add(Ze,"",Ke,Fe),e.add(et,"14",Ke,Fe),e.add(tt,"",Ke,Fe),e.add(st,"",Ke,Fe),e.add(at,"24",Ke,Fe),e.add(`${ot}${qe}`,!1,Ye,xe),e.add(`${ot}${Ve}`,!1,Ye,xe),e.send()}resolveBlockPage(e){let t=null;switch(e){case l.a.YELLOW:case l.a.RED:case l.a.PHISHING:t="html/block_page.html";break;case l.a.TYPOSQUATTING:t="html/typosquatting.html"}return t}resolveBrowserActionImages(e){const t=l.g[e]||"white";return{size16:`images/browser_action/${t}_16.png`,size20:`images/browser_action/${t}_20.png`,size32:`images/browser_action/${t}_32.png`,size40:`images/browser_action/${t}_40.png`}}searchAnnotation(e,t,s){const{cacheStore:n}=a.a,{GET:r,SET:i}=o.b;if(e===r){return s(n.get(T.c.SEARCH_ANNOTATION_OPTION)||o.a.ONLY_SECURE_SEARCH),!0}const c=t.searchAnnotationOption;if(e===i&&c){n.set(T.c.SEARCH_ANNOTATION_OPTION,c);let e=!1,t=!1;c===o.a.ALL?t=!0:c===o.a.ONLY_SECURE_SEARCH&&(e=!0,t=!0);const s=new u(this.nativeDispatcher);s.add(Qe,e,Ke,xe),s.add(Xe,t,Ye,xe),s.send()}return s(!0),!1}sendTelemetry(e){this.nativeDispatcher&&this.nativeDispatcher.sendTelemetry(e)}SetXYViewport(e,t){this.nativeDispatcher&&this.nativeDispatcher.SetXYViewport(e,t)}showNPSChecklist(e,t){this.nativeDispatcher&&this.nativeDispatcher.showNPSChecklist(e,t)}socialMediaAnnotation(e,t,s){const{cacheStore:n}=a.a,r=n.get(T.c.SOCIAL_MEDIA_ANNOTATION_OPTION)||p.c.NONE,i=n.get(T.c.SOCIAL_MEDIA_ANNOTATION_TOGGLE)||!1,{TOGGLE_ON:o,TOGGLE_OFF:c,ANNOTATION_ENABLE:l,ANNOTATION_ENABLE_ALL:E,ANNOTATION_DISABLE:_,ANNOTATION_DISABLE_ALL:d,GET:h}=p.b;if(e===h)return s({socialMediaOption:r,socialMediaToggle:i}),!0;if(e===o){const e=new u(this.nativeDispatcher);return e.add(`${rt}${m.a.getBrowserSuffix()}`,!0,Ke,xe),e.send(),n.set(T.c.SOCIAL_MEDIA_ANNOTATION_TOGGLE,!0),s({socialMediaOption:r,socialMediaToggle:!0}),!0}if(e===c){const e=new u(this.nativeDispatcher);e.add(`${rt}${m.a.getBrowserSuffix()}`,!1,Ke,xe),e.send(),n.set(T.c.SOCIAL_MEDIA_ANNOTATION_TOGGLE,!1)}if(e===E){const e=Object.values(p.c).reduce((e,t)=>e+t),t=new u(this.nativeDispatcher);t.add(`${nt}${m.a.getBrowserSuffix()}`,e,Ke,He),t.send(),n.set(T.c.SOCIAL_MEDIA_ANNOTATION_OPTION,e)}if(e===d){const e=p.c.NONE,t=new u(this.nativeDispatcher);t.add(`${nt}${m.a.getBrowserSuffix()}`,e,Ke,He),t.send(),n.set(T.c.SOCIAL_MEDIA_ANNOTATION_OPTION,e)}if(e===l){const{socialMediaType:e}=t;if(Object.values(p.c).includes(e)&&!(e&r)){const t=r+e;n.set(T.c.SOCIAL_MEDIA_ANNOTATION_OPTION,t);const s=new u(this.nativeDispatcher);s.add(`${nt}${m.a.getBrowserSuffix()}`,t,Ke,He),s.send()}}if(e===_){const{socialMediaType:e}=t;if(Object.values(p.c).includes(e)&&e&r){const t=r-e;n.set(T.c.SOCIAL_MEDIA_ANNOTATION_OPTION,t);const s=new u(this.nativeDispatcher);s.add(`${nt}${m.a.getBrowserSuffix()}`,t,Ke,He),s.send()}}return s(!0),!1}toBlockState(e){const t=m.a.toColor(e);let s=t,a=null;return e?(t!==l.d.RED&&t!==l.d.YELLOW||!m.a.isPhishingURI(e.cat)||(s=l.a.PHISHING),a={color:t,state:s}):a={color:l.d.UNKNOWN,state:l.a.UNKNOWN},a}toBlockPageUrl(e,t,s){let a=null;if([...l.a].includes(e)){const t=this.resolveBlockPage(e),n=s?"&cache=true":"";a=`${g.a.runtime.getURL(t)}?${n}`}return{actionImage:this.resolveBrowserActionImages(t),url:a}}toBrowserActionImages(e){const t=a.a.gtiCache.getReputation(e);if(!t||!t.cache_entry)return null;const s=this.toBlockState(t.cache_entry.value);return null===s?null:this.resolveBrowserActionImages(s.color)}toUrlReputation(e,t,s,a,n){m.a.isProperWebURL(e)?m.a.isHackerSafeUrl(e)?n({color:l.d.HACKERSAFE,statusOfBlocking:l.a.HACKERSAFE,whitelisted:!1}):this.makeGTIRequest(e,!1,[e],a,a=>{ke.getBlockPage(this.nativeDispatcher).then(()=>{const r=_.a.getDomain(e),i=d.isDomainInWhitelist(r,T.c.BLOCK_PAGE_WHITELIST);let o,c={},E=[];a&&a.annotationMap?(c=this.toBlockState(a.annotationMap[e]),({fromCache:o=!1}=a.annotationMap[e]),({cat:E=[]}=a.annotationMap[e])):(c.state=l.a.UNKNOWN,c.color=l.d.UNKNOWN),(i||c.state===l.a.GREEN||c.state===l.a.UNKNOWN)&&t>0&&s<=0?this.handleTyposquatting(e,(e,t)=>{n(null!==t?{color:c.color,statusOfBlocking:l.a.TYPOSQUATTING,whitelisted:e,typoDomain:t}:{color:c.color,statusOfBlocking:c.state,whitelisted:i,typoDomain:t})}):n({color:c.color,fromCache:o,statusOfBlocking:c.state,whitelisted:i,categories:E||[]})})}):n({color:l.d.UNKNOWN,statusOfBlocking:l.a.UNKNOWN,whitelisted:!1})}whitelist(e,t,s,n){const r=We.b[t];if(!t||!r)return a.a.logger.error(`invalid type: '${t}' or storeVariable: '${r}'`),n(!0),!1;const{ADD:i,GET:o,REMOVE:c,CLEAR:l}=We.a;if(e===o){return n(d.getDomainsFromWhitelist(r)),!0}if(e===i&&s.domains&&d.addDomainsToWhitelist(s.domains,r),e===c&&s.domains&&d.removeDomainFromWhitelist(s.domains,r),e===l&&d.clearWhitelist(r),t!==We.c.BLOCK_PAGE&&t!==We.c.IFRAME||ke.setBlockPage(this.nativeDispatcher),t===We.c.IFRAME&&s.tabId){const e={command:N.c.UNBLOCK_IFRAME,url:s.url};g.a.tabs.sendMessage(s.tabId,e,{frameId:s.frameId})}return n(!0),!1}shouldShowToast(e){this.nativeDispatcher&&this.nativeDispatcher.shouldShowToast(e)}closeToast(e){const t=m.a.getBrowserSuffix(),s=Math.round((new Date).getTime()/1e3),a=new u(this.nativeDispatcher);a.add(`${it}${t}`,e,Ye,xe),a.add(`${$e}${t}`,s,Ye,He),a.send()}updateTopFrame(e,t){const s=[];if(a.a.tabFrames[e])for(const t of a.a.tabFrames[e].subFrames){const e=new Promise(e=>{this.isFrameBlocked(t.url,s=>e({subFrame:t,response:s}))});s.push(e)}Promise.all(s).then(e=>{const s=[];e.forEach(({subFrame:e,response:t})=>{t.isBlocked&&s.push(e)}),t(s)})}updateBrowserAction(e,t,s){const a=Object.assign({},e);t||(a.tabId=s),g.a.browserAction.setBadgeText(a)}deleteMaliciousFile(e){this.nativeDispatcher&&this.nativeDispatcher.deleteMaliciousFile(e)}triggerDownloadScanningActionPanel(e){this.nativeDispatcher&&this.nativeDispatcher.triggerDownloadScanningActionPanel(e)}getExtensionStatus(e,t){this.nativeDispatcher&&this.nativeDispatcher.getExtensionStatus(e,t)}showPermRequestBalloon(){this.nativeDispatcher&&this.nativeDispatcher.showPermRequestBalloon()}}var lt=s(25);(new class{processActiveTab(){g.a.tabs.query({active:!0,currentWindow:!0},function(e){if(!e.length)return;const[t]=e,{url:s,id:n}=t;m.a.isProperWebURL(s)&&(a.a.messageDispatcher.onBeforeSendHeaders(s,n,0,void 0),a.a.messageDispatcher.onNavigate(s,n,0))})}initListeners(){const e=(new De).getListeners();for(const t of e)t.init()}setupFeatures(){if(a.a.browserType===l.b.CHROME&&a.a.PPS_MODE&&(a.a.SMA_FEATURE_DISABLED=!1,a.a.AP_FEATURE_ENABLED=!1,a.a.CRYPTOJACKING_FEATURE_DISABLED=!0,a.a.cacheStore.set(T.a.DOWNLOAD_SCANNING_QUEUE,[])),a.a.SMA_FEATURE_DISABLED){const e=l.b.EDGE===l.c.BROWSER_TYPE?"html/popup.html":"html/popup_simple.html";g.a.browserAction.setPopup({popup:e})}else g.a.browserAction.setPopup({popup:""});a.a.AP_FEATURE_ENABLED&&lt.a.pingSE().then(()=>{a.a.cacheStore.set(T.c.SEARCH_ANNOTATION_OPTION,o.a.ONLY_SECURE_SEARCH)}).catch(()=>{a.a.cacheStore.set(T.c.SEARCH_ANNOTATION_OPTION,o.a.NONE)}),window.AdBlocker=void 0}submain(){Ce.connect(async(e,t,s)=>{const n=ie.createDispatcher(t);null!==n&&await n.init(e,s),this.setupFeatures(),a.a.messageDispatcher=new ct(n),this.initListeners(),this.processActiveTab()})}main(){a.a.logger=new O.c,a.a.browserType=l.c.BROWSER_TYPE,a.a.userAgentInBase64=window.btoa(navigator.userAgent),Re.generateWASM().then(e=>{a.a.wasm=e;const t=a.a.browserType===l.b.FIREFOX?g.a.i18n.getMessage("@@extension_id"):"";a.a.wasm.init(t).then(e=>{"0"===e&&(this.submain(),a.a.logger.log(`WASM initiation: ${e}`))}).catch(e=>{a.a.logger.error(e)})}).catch(e=>{a.a.logger.error(e)})}}).main()},11:function(e,t,s){"use strict";s.d(t,"b",function(){return a}),s.d(t,"a",function(){return n}),s.d(t,"c",function(){return r});const a={GET:"GET",SET:"SET"},n={NONE:"NONE",ONLY_SECURE_SEARCH:"ONLY_SECURE_SEARCH",ALL:"ALL"},r={UNKNOWN:0,GOOGLE:1,YAHOO:2,AOL:3,ASK:4,UOL:5,GOO:6,MYWAY:7,TERRA:8,WEB:9,BIGLOBE:10,GMX:11,EXCITE:12,SKY:13,NAVER:14,NIFTY:15,RAKUTEN:16,IXQUICK:17,XFINITY:18,SOGOU:19,DOGPILE:20,SEARCH:21,WEBCRAWLER:22,BING:23,INFO:24,YANDEX:25,YIPPY:26,WOW:27,HAOSO:28,DUCKDUCKGO:30,LINKEDIN:100,FACEBOOK:101,YOUTUBE:102,INSTAGRAM:103,REDDIT:104,TWITTER:105}},13:function(e,t,s){"use strict";s.d(t,"c",function(){return a}),s.d(t,"b",function(){return n}),s.d(t,"a",function(){return r});const a={NONE:0,LINKEDIN:1,INSTAGRAM:2,YOUTUBE:4,FACEBOOK:8,TWITTER:16,REDDIT:32},n={TOGGLE_ON:"TOGGLE_ON",TOGGLE_OFF:"TOGGLE_OFF",ANNOTATION_ENABLE_ALL:"ANNOTATION_ENABLE_ALL",ANNOTATION_DISABLE_ALL:"ANNOTATION_DISABLE_ALL",ANNOTATION_ENABLE:"ANNOTATION_ENABLE",ANNOTATION_DISABLE:"ANNOTATION_DISABLE",GET:"GET"},r={BADGE:"BADGE",SIDEBAR:"SIDEBAR",NONE:"NONE",STOP:"STOP"}},14:function(e,t,s){"use strict";s.d(t,"a",function(){return a});class a{constructor(){this._extnMap=new Map,this._extnMap.set("WebBoost","klekeajafkkpokaofllcadenjdckhinm"),this._extnMap.set("SearchExtension","enppghjcblldgigemljohkgpcompnjgh")}isWhiteListed(e){const t=this._extnMap.values();for(const s of t)if(s===e)return!0;return!1}get(e){return this._extnMap.get(e)}getExtnIds(){return this._extnMap.values()}}},15:function(e,t,s){"use strict";s.d(t,"a",function(){return r});var a=s(5),n=s(3);class r{static getHtml(e,t){a.a.resourceRequestor.getHtml(e,s=>{s?t(s):n.a.logError(`Failed to fetch html ${e}`)})}static getImage(e,t){a.a.resourceRequestor.getImage(e,s=>{s?t(s):n.a.logError(`Image ${e} failed to fetch through resource requestor`)})}static getJSON(e,t){a.a.resourceRequestor.getJSON(e,s=>{s?t(s):n.a.logError(`Failed to fetch json ${e}`)})}static getLocalizedString(e){return a.a.resourceRequestor.geti18nRes(e)}static getResString(e,t){a.a.resourceRequestor.getResStr(e,s=>{s?t(s):n.a.logError(`Resource string ${e} failed to fetch through resource requestor`)})}}},18:function(e,t,s){"use strict";s.d(t,"b",function(){return a}),s.d(t,"c",function(){return i}),s.d(t,"a",function(){return o});const a={reputationTTL:36e5,maxGTIQuestionLength:16384,globalSafeModeFlag:536870912,contentType:"application/json; charset=utf-8",clientId:"87d8d1082c2f2f821f438b2359b7a5b4",prn:"McAfee WebAdvisor",sdkv:"1.0",pv:s(0).c.EXTENSION_VERSION,pev:1,serverURL:"https://webadvisorc.rest.gti.mcafee.com/1",gtiId:"is-webadvisorc-prod",customerId:"Customer0008"},n=64,r=function(e){this.cliid=a.clientId,this.prn=a.prn,this.sdkv=a.sdkv,this.pv=a.pv,this.pev=a.pev,this.rid=e,this.affid="0",this.cid=a.customerId},i=function(){this.op=null,this.uop=n,this.url=null,this.catset=4},o=function(e){this.ci=new r(e),this.q=[]}},19:function(e,t,s){"use strict";s.d(t,"a",function(){return a});class a{onHttpResponse(e){if(!e.ok){const t=`HttpService Status: ${e.status}\nError Text: ${e.statusText}`;return Promise.reject(new Error(t))}return e}sendHttpRequest({url:e,headers:t,body:s,method:a="GET"}){return fetch(e,{headers:t,method:a,body:s}).then(this.onHttpResponse)}}},2:function(e,t,s){"use strict";s.d(t,"b",function(){return a}),s.d(t,"c",function(){return n}),s.d(t,"h",function(){return r}),s.d(t,"j",function(){return i}),s.d(t,"i",function(){return o}),s.d(t,"g",function(){return c}),s.d(t,"f",function(){return l}),s.d(t,"d",function(){return E}),s.d(t,"e",function(){return _}),s.d(t,"a",function(){return d});const a={CACHE_STORE:"CACHE_STORE",CONTENT_HANDLER:"CONTENT_HANDLER",EXECUTE_COMMAND:"EXECUTE_COMMAND",FOCUS_OR_CREATE_TAB:"FOCUS_OR_CREATE_TAB",GET_BK_GLOBALS:"GET_BK_GLOBALS",GET_EXTENSION_STATUS:"GET_EXTENSION_STATUS",GET_TAB_DATA:"GET_TAB_DATA",GET_VALUES:"GET_VALUES",GTI_REQUEST:"GTI_REQUEST",INSTALL_EXTENSION:"INSTALL_EXTENSION",LOGGER:"LOGGER",PLACEHOLDER_TEXT:"PLACEHOLDER_TEXT",REMOVE_TAB:"REMOVE_TAB",SEND_TELEMETRY:"SEND_TELEMETRY",SET_TAB_ACTION_PANEL_DATA:"SET_TAB_ACTION_PANEL_DATA",SET_VIEWPORT:"SET_VIEWPORT",UPDATE_BROWSER_ACTION:"UPDATE_BROWSER_ACTION",WHITELIST:"WHITELIST",GET_POPUP_DATA:"GET_POPUP_DATA",GET_SETTINGS_DATA:"GET_SETTINGS_DATA",RESET_SETTINGS:"RESET_SETTINGS",SHOW_OPTIONS:"SHOW_OPTIONS",ADD_ADBLOCK_WHITELIST:"ADD_ADBLOCK_WHITELIST",GET_COSMETIC_FILTERS:"GET_COSMETIC_FILTERS",REMOVE_ADBLOCK_WHITELIST:"REMOVE_ADBLOCK_WHITELIST",TOGGLE_ADBLOCK_ENGINE:"TOGGLE_ADBLOCK_ENGINE",SHOW_PERM_REQUEST_BALLOON:"SHOW_PERM_REQUEST_BALLOON",AUTO_RUN_VIDEO_SITE:"AUTO_RUN_VIDEO_SITE",GET_CLICK_EVENT_TIME:"GET_CLICK_EVENT_TIME",SAVE_CLICK_EVENT_TIME:"SAVE_CLICK_EVENT_TIME",ADD_PAGE_SCAN_STAT:"ADD_PAGE_SCAN_STAT",CLOSE_TOAST:"CLOSE_TOAST",SHOULD_SHOW_TOAST:"SHOULD_SHOW_TOAST",GET_TYPOSQUATTING_DATA:"GET_TYPOSQUATTING_DATA",IS_FRAME_BLOCKED:"IS_FRAME_BLOCKED",IS_PAGE_BLOCKED:"IS_PAGE_BLOCKED",IS_WHITELISTED:"IS_WHITELISTED",UPDATE_TOP_FRAME:"UPDATE_TOP_FRAME",VIEW_SITE_REPORT:"VIEW_SITE_REPORT",SEARCH_ANNOTATION:"SEARCH_ANNOTATION",UPDATE_ENGINE_STATS:"UPDATE_ENGINE_STATS",SHOW_NPS_CHECKLIST:"SHOW_NPS_CHECKLIST",SOCIAL_MEDIA_ANNOTATION:"SOCIAL_MEDIA_ANNOTATION",RELOAD_SIDEBAR_PANEL:"RELOAD_SIDEBAR_PANEL",DOWNLOAD_SCANNING_DELETE_FILE:"DOWNLOAD_SCANNING_DELETE_FILE",TRIGGER_NEXT_EVENT_FOR_DOWNLOAD_SCANNING:"TRIGGER_NEXT_EVENT_FOR_DOWNLOAD_SCANNING",REMOVE_FROM_DOWNLOAD_SCAN_QUEUE:"REMOVE_FROM_DOWNLOAD_SCAN_QUEUE"},n={UNBLOCK_IFRAME:"UNBLOCK_IFRAME",RETRY_IFRAME:"RETRY_IFRAME",NAVIGATE_TO_URL:"NAVIGATE_TO_URL",FLOATING_BALLOON:"FLOATING_BALLOON",PAGE_OVERLAY:"PAGE_OVERLAY",SIDEBAR:"SIDEBAR",TOAST:"TOAST",TOPBAR:"TOPBAR"},r={BLOCK_PAGE:"BLOCK_PAGE",CLOSE:"CLOSE",DOWNLOAD_SCANNING_MALICIOUS:"DOWNLOAD_SCANNING_MALICIOUS",DOWNLOAD_SCANNING_FILE_DELETED:"DOWNLOAD_SCANNING_FILE_DELETED",DOWNLOAD_SCANNING_FILE_NOT_DELETED:"DOWNLOAD_SCANNING_FILE_NOT_DELETED",IFRAME_BLOCK:"IFRAME_BLOCK",MAIN:"MAIN",RELOAD:"RELOAD",SITE_REPORT:"SITE_REPORT",SHOW:"SHOW",SMA:"SMA",SS_ACCEPTED:"SS_ACCEPTED"},i={SHOW:"SHOW",CLOSE:"CLOSE",RELOAD:"RELOAD",CRYPTO_BLOCK:"CRYPTO_BLOCK",IFRAME_BLOCK:"IFRAME_BLOCK",TRIGGER_ALLOW:"TRIGGER_ALLOW"},o={SHOW:"SHOW",CLOSE:"CLOSE",RELOAD:"RELOAD",SECURE_SEARCH:"SECURE_SEARCH"},c={SHOW:"SHOW",CLOSE:"CLOSE",RELOAD:"RELOAD",SEARCH_EXTENSION_OVERLAY:"SEARCH_EXTENSION_OVERLAY",FINISH_DOWNLOAD:"FINISH_DOWNLOAD"},l={UPDATE_AD_COUNT:"UPDATE_AD_COUNT",UPDATE_TRACKER_COUNT:"UPDATE_TRACKER_COUNT",UPDATE_DOWNLOAD_SCAN_COUNT:"UPDATE_DOWNLOAD_SCAN_COUNT",HIDE_BUBBLE:"HIDE_BUBBLE"},E={PING:0,DISCONNECT_NATIVE:1,ADBLOCK:"ADBLOCK"},_={PONG:0},d={ADD_WHITELIST:"ADD_WHITELIST",REMOVE_WHITELIST:"REMOVE_WHITELIST",IS_DISABLED:"IS_DISABLED",AD_BLOCKED:"AD_BLOCKED",TRACKER_BLOCKED:"TRACKER_BLOCKED",TURN_ON:"TURN_ON",TURN_OFF:"TURN_OFF",ADBLOCKER_READY:"ADBLOCKER_READY"}},21:function(e,t,s){"use strict";s.d(t,"a",function(){return a});class a{constructor(){this.tlds=null,this.getTlds()}getTlds(){fetch("https://publicsuffix.org/list/public_suffix_list.dat").then(e=>e.ok?e.text():null).then(e=>{const t=a.parseTLDData(e);this.tlds=t}).catch(()=>{return null})}static parseTLDData(e){const t={};if(!e)return null;const s=e.split(/\n/);for(let e=0;e<s.length;e+=1){let a=s[e];if(!a)continue;const n=a.indexOf("//");if(0===n)continue;n>0&&(a=a.substring(0,n));const r=a.replace(/^(\s|!|\*\.)/g,"");let i=(a.match(/\./g)||[]).length+1;i-=a.startsWith("!")?1:0,t[r]=i}return 0===Object.keys(t).length&&t.constructor===Object?null:t}parse(e){const t={hostname:"",subdomain:"",domain:"",domainOnly:"",suffix:""},s=new URL(e);if(!this.tlds||!s)return t;const{origin:a}=s,n=a.split(".");let r="",i=1;for(let e=n.length-1;e>=0;e-=1){const t=n[e];if(r=r?`${t}.${r}`:t,!this.tlds[r])break;i=this.tlds[r]}return n.length<=i?t:(t.subdomain=n.slice(0,-i-1).join("."),t.domain=n.slice(-i-1).join("."),t.domainOnly=n.slice(-i-1,-i).join("."),t.suffix=n.slice(-i).join("."),t.hostname=s.hostname,t)}static getURI(e){let t=e.split("?");return t.length>1?t[0]:(t=e.split("#")).length>1?t[0]:e}static getCleanURI(e){let t=e;return t.endsWith("/")&&(t=t.slice(0,-1)),t.startsWith("http://")?t=t.slice(7):t.startsWith("https://")&&(t=t.slice(8)),this.getURI(t)}static getParam(e,t){const s=e.indexOf("?");if(-1===s)return null;const a=e.substring(s+1).split("&");for(let e=0;e<a.length;++e){const s=a[e].indexOf("=");if(-1!==s&&a[e].substring(0,s)===t){return a[e].substring(s+1)}}return null}static getDomain(e){if(void 0===e||!/^https?:\/\//.test(e))return"";return new URL(e).hostname}}},22:function(e,t,s){"use strict";s.d(t,"c",function(){return n}),s.d(t,"b",function(){return r}),s.d(t,"a",function(){return i});var a=s(8);const n={BLOCK_PAGE:"BLOCK_PAGE",CRYPTOJACKING:"CRYPTOJACKING",TYPOSQUATTING:"TYPOSQUATTING",IFRAME:"IFRAME"},r={BLOCK_PAGE:a.c.BLOCK_PAGE_WHITELIST,CRYPTOJACKING:a.c.CRYPTO_WHITELIST,TYPOSQUATTING:a.c.TYPOSQUATTING_WHITELIST,IFRAME:a.c.BLOCK_PAGE_WHITELIST},i={ADD:"ADD",GET:"GET",REMOVE:"REMOVE",CLEAR:"CLEAR"}},25:function(e,t,s){"use strict";s.d(t,"a",function(){return r});var a=s(2),n=s(5);class r{static isAdblockDisabled(e){const t=n.a.externalExtensions.get("SearchExtension"),s={command:a.a.IS_DISABLED,tabId:e},r={request_type:a.d.ADBLOCK,payload:s};return n.a.externalMsgDispatcher.sendExtnMsg(t,r)}static updateAdblockWhitelist(e,t){const s=n.a.externalExtensions.get("SearchExtension"),r={command:e,tabId:t},i={request_type:a.d.ADBLOCK,payload:r};return n.a.externalMsgDispatcher.sendExtnMsg(s,i)}static toggleAdblockEngine(e){const t=n.a.externalExtensions.get("SearchExtension"),s={command:e?a.a.TURN_ON:a.a.TURN_OFF},r={request_type:a.d.ADBLOCK,payload:s};return n.a.externalMsgDispatcher.sendExtnMsg(t,r)}static pingSE(){const e=n.a.externalExtensions.get("SearchExtension"),t={request_type:a.d.PING,payload:{}};return n.a.externalMsgDispatcher.sendExtnMsg(e,t)}}},3:function(e,t,s){"use strict";s.d(t,"a",function(){return l});var a=s(1),n=s(2),r=s(0),i=s(7),o=s(10),c=s(5);class l{static handlePromiseMessage(e,t=null){return new Promise((s,n)=>{a.a.runtime.sendMessage(e,e=>{"function"==typeof t?t(s,n,e):((e,t,s)=>{a.a.runtime.lastError&&t(a.a.runtime.lastError.message),e(s)})(s,n,e)})})}static logger(e,t){if(Object(o.f)()!==o.a.NONE){Object(o.e)(e,t,o.d.CONTENT);const s=n.b.LOGGER;a.a.runtime.sendMessage({command:s,message:e,logType:t})}}static logError(e){l.logger(e,o.b.ERROR)}static logInfo(e){l.logger(e,o.b.INFO)}static cacheStore(e,t){const s=n.b.CACHE_STORE;return this.handlePromiseMessage({command:s,action:e,data:t})}static saveLastClickedTime(){const e=n.b.SAVE_CLICK_EVENT_TIME;a.a.runtime.sendMessage({command:e,last_event:Date.now()})}static getLastClickedTime(){const e=n.b.GET_CLICK_EVENT_TIME;return this.handlePromiseMessage({command:e})}static autoRunVideo(e){const t=n.b.AUTO_RUN_VIDEO_SITE;a.a.runtime.sendMessage({command:t,url:e})}static isPageBlocked(e){const t=n.b.IS_PAGE_BLOCKED;return this.handlePromiseMessage({command:t,url:e})}static isFrameBlocked(e){const t=n.b.IS_FRAME_BLOCKED;return this.handlePromiseMessage({command:t,url:e})}static makeGTIRequest(e,t,s,a){const r={command:n.b.GTI_REQUEST,url:e,isSecureSearch:t,requestData:s,referer:a};return this.handlePromiseMessage(r)}static executeCommand(e,t){const s=n.b.EXECUTE_COMMAND;a.a.runtime.sendMessage({command:s,commandId:e,params:t})}static focusOrCreateTab(e){const t=n.b.FOCUS_OR_CREATE_TAB;a.a.runtime.sendMessage({command:t,url:e})}static closeTab(){const e=n.b.REMOVE_TAB;a.a.runtime.sendMessage({command:e})}static addPageScanStat(){const e=n.b.ADD_PAGE_SCAN_STAT;a.a.runtime.sendMessage({command:e})}static whitelist(e,t,s){const a=n.b.WHITELIST;return this.handlePromiseMessage({action:e,command:a,type:t,data:s})}static getPopupData(){const e=n.b.GET_POPUP_DATA;return this.handlePromiseMessage({command:e})}static getSettingsData(){const e=n.b.GET_SETTINGS_DATA;return this.handlePromiseMessage({command:e})}static searchAnnotation(e,t){const s=n.b.SEARCH_ANNOTATION;return this.handlePromiseMessage({action:e,data:t,command:s})}static socialMediaAnnotation(e,t){const s=n.b.SOCIAL_MEDIA_ANNOTATION;return this.handlePromiseMessage({action:e,data:t,command:s})}static getBkGlobals(){const e=n.b.GET_BK_GLOBALS;return this.handlePromiseMessage({command:e})}static viewSiteReport(e=null,t=!1){const s=n.b.VIEW_SITE_REPORT;a.a.runtime.sendMessage({command:s,url:e,showInNewTab:t})}static getTypoSquattingData(e){const t=n.b.GET_TYPOSQUATTING_DATA;return this.handlePromiseMessage({command:t,domain:e})}static getPlaceholderText(e){const t=n.b.PLACEHOLDER_TEXT;return this.handlePromiseMessage({command:t,id:e})}static setViewPort(e,t){const s=n.b.SET_VIEWPORT;a.a.runtime.sendMessage({command:s,x:e,y:t})}static sendTelemetry(e){const t=n.b.SEND_TELEMETRY;a.a.runtime.sendMessage({command:t,telemetry:e})}static updateTopFrame(){return this.handlePromiseMessage({command:n.b.UPDATE_TOP_FRAME},(e,t,s)=>{a.a.runtime.lastError?t(a.a.runtime.lastError.message):s.length?e(s):t()})}static updateBrowserAction(e,t=!1){const s=n.b.UPDATE_BROWSER_ACTION;a.a.runtime.sendMessage({details:e,allTabs:t,command:s})}static resetSettings(){const e=n.b.RESET_SETTINGS;a.a.runtime.sendMessage({command:e})}static showOptions(e){const t=n.b.SHOW_OPTIONS;a.a.runtime.sendMessage({command:t,url:e})}static sendEngineStat(e){a.a.runtime.sendMessage({command:n.b.UPDATE_ENGINE_STATS,engine:e})}static contentHandler(e){const t=n.b.CONTENT_HANDLER;a.a.runtime.sendMessage({command:t,message:e})}static shouldShowToast(){const e=n.b.SHOULD_SHOW_TOAST;return this.handlePromiseMessage({command:e})}static closeToast(e){const t=n.b.CLOSE_TOAST;a.a.runtime.sendMessage({command:t,userConfirmation:e})}static showNPSChecklist(e){const t=n.b.SHOW_NPS_CHECKLIST,s=window.location.href;a.a.runtime.sendMessage({command:t,fromBlockPage:e,location:s})}static updateAdblockWhitelist(e){a.a.runtime.sendMessage({command:e})}static toggleAdblockEngine(e){const t=n.b.TOGGLE_ADBLOCK_ENGINE;a.a.runtime.sendMessage({command:t,enableAdblockEngine:e})}static setTabActionPanelData(e){const t=n.b.SET_TAB_ACTION_PANEL_DATA;a.a.runtime.sendMessage({command:t,data:e})}static getTabData(e={}){const t={command:n.b.GET_TAB_DATA,...e};return this.handlePromiseMessage(t)}static isWhitelisted(e){const t={command:n.b.IS_WHITELISTED,url:e};return this.handlePromiseMessage(t)}static reloadSideBarPanel(){const e=n.b.RELOAD_SIDEBAR_PANEL;a.a.runtime.sendMessage({command:e})}static deleteMaliciousFile(e){const t=n.b.DOWNLOAD_SCANNING_DELETE_FILE;a.a.runtime.sendMessage({command:t,payload:e})}static triggerNextEventForDownloadScanning(){const e=n.b.TRIGGER_NEXT_EVENT_FOR_DOWNLOAD_SCANNING;a.a.runtime.sendMessage({command:e})}static removeFromDownloadScanQueue(){const e=n.b.REMOVE_FROM_DOWNLOAD_SCAN_QUEUE;a.a.runtime.sendMessage({command:e})}static getSEStatus(){const e=c.a.externalExtensions.get("SearchExtension"),t=n.b.GET_EXTENSION_STATUS;return this.handlePromiseMessage({command:t,extension_id:e})}static installSE(){const e=c.a.externalExtensions.get("SearchExtension"),t=n.b.INSTALL_EXTENSION,s=r.j[i.a.browserTypeToString()];a.a.runtime.sendMessage({command:t,extension_id:e,redirect_url:s})}static showPermRequestBalloon(){const e=n.b.SHOW_PERM_REQUEST_BALLOON;a.a.runtime.sendMessage({command:e})}}},39:function(e,t,s){"use strict";s.d(t,"a",function(){return r});var a=s(11),n=s(13);const r={searchengines:[{name:"yahoo",enabled:!0,sourcetype:a.c.YAHOO,secureurlre:["^http(s)?:\\/\\/(([a-z][a-z]|chfr|chit|malaysia|espanol)\\.)?(yhs[0-9]\\.)?(www|search|myweb|myweb2|news\\.search|espanol\\.search|search\\.cn|one\\.cn)\\.yahoo\\.[a-z\\.]+\\/(search|custom|s|404handler|yhs).*fr=(mcafee|mcasa|mcsaoffblock|slv8-mc).*"],urlre:["^http(s)?:\\/\\/(([a-z][a-z]|chfr|chit|malaysia|espanol)\\.)?(yhs[0-9]\\.)?(www|search|myweb|myweb2|news\\.search|espanol\\.search|search\\.cn|one\\.cn)\\.yahoo\\.[a-z\\.]+\\/(search|custom|s|404handler|yhs)"],selectors:[{selector:"ul>li>h3>a",parent:!0,inline:!0,matched:0},{selector:"ol>li>h3>a",parent:!0,inline:!0,matched:0},{selector:"ul>li>label>a",parent:!0,inline:!0,matched:0},{selector:"p.txt>a",parent:!0,inline:!0,matched:0},{selector:"div.sw-Card__headerSpace > div.sw-Card__title.sw-Card__title--cite > a:first-child",child:"h3:first-child",parent:!0,inline:!0,matched:0,styles:{top:"6px"}},{selector:"ul.compArticleList li>h4>a",parent:!1,inline:!1,matched:0},{selector:"div.ads div>h3>a, div.algo div>h3>a",parent:!1,inline:!0,matched:0,filterURI:{filterType:0,startsWith:"/ru=",endsWith:"/rk="}},{selector:"div.ads div>ul>li>a, div.algo div>ul>li>a",parent:!1,inline:!0,matched:0,filterURI:{filterType:0,startsWith:"/ru=",endsWith:"/rk="}},{selector:"div.ads-container div>h3>a",parent:!0,inline:!0,matched:0,filterURI:{filterType:0,startsWith:"/ru=",endsWith:"/rk="}},{selector:"div.ads div.aTitle>p>a, div.algo div.aTitle>p>a",parent:!0,inline:!0,matched:0,filterURI:{filterType:0,startsWith:"/ru=",endsWith:"/rk="}},{selector:"div.w div>h3>a",parent:!1,matched:0,inline:!0}]},{name:"google",enabled:!0,sourcetype:a.c.GOOGLE,urlre:["^http(s)?:\\/\\/(w+|america|news|encrypted|www\\.l)\\.google\\.[a-z\\.]+\\/search"],selectors:[{selector:"h3.r>a",parent:!0,matched:0,hrefattr:["data-href"],inline:!0},{selector:"div.rc>div.r>a",parent:!1,matched:0,child:"h3.LC20lb",inline:!0},{selector:"li>h3>a:nth-child(2)",parent:!0,matched:0,inline:!0},{selector:"div._I2>a",parent:!0,matched:0,hrefattr:["data-href"],inline:!1}]},{name:"bing",enabled:!0,sourcetype:a.c.BING,secureurlre:["^http(s)?:\\/\\/(www[0-9]*|it|hk|jp|br|be|nz)\\.(bing|search)\\.(com|daum)(\\.net|\\/fbf)?\\/(news|search|bing).*PC=MC.*"],urlre:["^http(s)?:\\/\\/(www[0-9]*|it|hk|jp|br|be|nz)\\.(bing|search)\\.(com|daum)(\\.net|\\/fbf)?\\/(news|search|bing)","^http(s)?:\\/\\/www\\.msnbc\\.msn\\.com\\/\\?id"],selectors:[{selector:"ol>li>h2>a",parent:!0,matched:0,inline:!0},{selector:"ul>li>h3>a",parent:!0,matched:0,inline:!0}]},{name:"yandex",enabled:!0,sourcetype:a.c.YANDEX,secureurlre:["^http(s)?:\\/\\/(www\\.)?yandex\\.ru\\/search\\/\\?.*clid=2285101.*"],urlre:["^http(s)?:\\/\\/(www\\.)?yandex\\.(com|ru|by|kz|com\\.tr|ua)\\/search"],selectors:[{selector:"div.serp-item>h2.serp-item__title>a",parent:!0,matched:0,inline:!0},{selector:"div.organic>h2.organic__title-wrapper>a",parent:!0,matched:0,inline:!0}]},{name:"duckduckgo",enabled:!0,sourcetype:a.c.DUCKDUCKGO,urlre:["^http(s)?:\\/\\/(www\\.)?(duckduckgo\\.com)"],secureurlre:["^http(s)?:\\/\\/(www\\.)?(duckduckgo\\.com)(\\/)?.*frcode=test.*$"],selectors:[{selector:"h2.result__title>a.result__a",parent:!1,matched:0,inline:!0}]},{name:"dogpile",enabled:!0,sourcetype:a.c.DOGPILE,urlre:["^http(s)?:\\/\\/(www\\.)?dogpile\\.com\\/serp"],selectors:[{selector:"div.web-bing__result>a.web-bing__title",parent:!1,matched:0,inline:!0}]},{name:"search",enabled:!0,sourcetype:a.c.SEARCH,urlre:["^http(s)?:\\/\\/(www\\.)?(search\\.com)\\/web"],selectors:[{selector:"h3.web-result-title>a",parent:!1,matched:0,inline:!0},{selector:"li.top-ads-item ",parent:!1,matched:0,inline:!0}]},{name:"yippy",enabled:!0,sourcetype:a.c.YIPPY,urlre:["^http(s)?:\\/\\/(www\\.)?(yippy\\.com)\\/search"],selectors:[{selector:"div>span.values>span.value>a",parent:!1,matched:0,inline:!0}]},{name:"wow",enabled:!0,sourcetype:a.c.WOW,urlre:["^http(s)?:\\/\\/(www\\.)?(wow\\.com)\\/search"],selectors:[{selector:"div>h3.title>a",parent:!1,matched:0,inline:!0}]},{name:"so",enabled:!0,sourcetype:a.c.HAOSO,urlre:["^http(s)?:\\/\\/(www\\.)?(so\\.com)\\/s"],selectors:[{selector:"li.res-list>h3>a",parent:!1,matched:0,inline:!0}]},{name:"sogou",enabled:!0,sourcetype:a.c.SOGOU,urlre:["^http(s)?:\\/\\/(www\\.)?(.sogou\\.com)\\/web"],selectors:[{selector:"h2.pz-head-title>a",parent:!1,matched:0,inline:!0},{selector:"h3.pt>a",parent:!1,matched:0,inline:!0},{selector:"h3.vrTitle>a",parent:!1,matched:0,inline:!0}]},{name:"webcrawler",enabled:!0,sourcetype:a.c.WEBCRAWLER,urlre:["^http(s)?:\\/\\/(www\\.)?(webcrawler\\.com)\\/serp"],selectors:[{selector:"div.adD>div>div>a",parent:!1,matched:0,inline:!0},{selector:"div.web-bing__result>a.web-bing__title",parent:!1,matched:0,inline:!0}]},{name:"info",enabled:!0,sourcetype:a.c.INFO,urlre:["^http(s)?:\\/\\/(www\\.)?(info\\.com)\\/serp"],selectors:[{selector:"div.ads-bing-top>span.ads-bing-top__label>a",parent:!1,matched:0,inline:!0},{selector:"div.web-bing__result>a.web-bing__title",parent:!1,matched:0,inline:!0}]},{name:"daum",enabled:!0,sourcetype:a.c.DAUM,urlre:["^http(s)?:\\/\\/(search\\.daum\\.net)\\/search"],selectors:[{selector:"div.cont_inner>div[class^=wrap_tit]>a",parent:!1,matched:0,inline:!0},{selector:"div.coll_cont>ul>li>a",parent:!1,matched:0,inline:!0}]},{name:"facebook",socialMediaType:n.c.FACEBOOK,sourcetype:a.c.FACEBOOK,enabled:!1,urlre:["^http(s)?:\\/\\/(www|m)\\.facebook\\.com"],selectors:[{selector:"div.userContent a",hrefqstring:"u",excluderegex:"^http(s)?:\\/\\/.*\\.facebook\\.com",parent:!1,matched:0,inline:!1},{selector:"div.mbs a",hrefqstring:"u",excluderegex:"^http(s)?:\\/\\/.*\\.facebook\\.com",parent:!1,matched:0,inline:!1},{selector:"span.UFICommentBody a",hrefqstring:"u",excluderegex:"^http(s)?:\\/\\/.*\\.facebook\\.com",parent:!1,matched:0,inline:!1},{selector:"table.conversationContainer a",hrefqstring:"u",excluderegex:"^http(s)?:\\/\\/.*\\.facebook\\.com",parent:!1,matched:0,inline:!1},{selector:"div[aria-label=Messages] a",hrefqstring:"u",excluderegex:"^http(s)?:\\/\\/.*\\.facebook\\.com",parent:!1,matched:0,inline:!1},{selector:"tr#vertex-info-item-website a",hrefqstring:"u",excluderegex:"^http(s)?:\\/\\/.*\\.facebook\\.com",parent:!1,matched:0,inline:!1},{selector:"div#pages_side_column a:last-child",hrefqstring:"u",excluderegex:"^http(s)?:\\/\\/.*\\.facebook\\.com",parent:!1,matched:0,inline:!1},{selector:"span.fbPhotosPhotoCaption a",hrefqstring:"u",excluderegex:"^http(s)?:\\/\\/.*\\.facebook\\.com",parent:!1,matched:0,inline:!1},{selector:"div[aria-label=Comment] a",hrefqstring:"u",excluderegex:"^http(s)?:\\/\\/.*\\.facebook\\.com",parent:!1,matched:0,inline:!1},{selector:'div[aria-label="Comment reply"] span>a',hrefqstring:"u",excluderegex:"^http(s)?:\\/\\/.*\\.facebook\\.com",parent:!1,matched:0,inline:!1},{selector:"div.uiContextualLayerParent div.fbNubFlyoutInner > div span>a",hrefqstring:"u",excluderegex:"^http(s)?:\\/\\/.*\\.facebook\\.com",parent:!1,matched:0,inline:!0}]},{name:"ask",enabled:!0,sourcetype:a.c.ASK,urlre:["^http(s)?:\\/\\/((www|search|ru|fr|de|uk|it|nl|es|eu|jp|br|ca|mx|pl|no|dk|se|us|au|in|ar|pt)\\.)?(uk\\.)?ask\\.(com|jp)\\/(web|pictures|news|videos|ref|ans)(\\.asp)?\\?"],selectors:[{selector:"div[class^=PartialSearchResults-item-title]>a",parent:!0,matched:0,inline:!0},{selector:"div[class^=adD]>div>div>a",parent:!0,matched:0,inline:!0},{selector:"div[class^=sa]>a",parent:!1,matched:0,inline:!0}]},{name:"aol",enabled:!0,sourcetype:a.c.AOL,urlre:["^http(s)?:\\/\\/(recherche|suche|search|search\\.cn)\\.aol\\.(jp|cn|fr|ca|com\\.mx|co\\.uk|de|in|com|com\\.au)\\/"],selectors:[{selector:"div[class$=options-toggle]>h3>a",parent:!0,inline:!0,matched:0,filterURI:{filterType:0,startsWith:"/ru=",endsWith:"/rk="}},{selector:"li[class^=mb-12]>a",parent:!1,inline:!0,matched:0,filterURI:{filterType:0,startsWith:"/ru=",endsWith:"/rk="}}]},{name:"uol",enabled:!0,sourcetype:a.c.UOL,urlre:["^http(s)?:\\/\\/((mundo|brasil)\\.)?busca\\.uol\\.com\\.br\\/(((www|uol|br)\\/index\\.html\\?)|(buscar\\.html))?"],selectors:[{selector:"a[class^=gs-title]",parent:!1,matched:0,inline:!0}]},{name:"goo",enabled:!0,sourcetype:a.c.GOO,urlre:["^http(s)?:\\/\\/search\\.goo\\.ne\\.jp\\/web\\.jsp\\?"],selectors:[{selector:"div[class=result]>p[class^=title]>a",parent:!0,matched:0,inline:!0}]},{name:"myway",enabled:!0,sourcetype:a.c.MYWAY,urlre:["^http(s)?:\\/\\/(search)\\.myway\\.com\\/(search|jsp)\\/(AJ|GG|AW|LS|GG)(main|web|advr)\\.(jsp|jhtml)"],selectors:[{selector:"ol>li>div>a.algo-title",parent:!0,matched:0,inline:!0}]},{name:"terra",enabled:!0,sourcetype:a.c.TERRA,urlre:["^http(s)?:\\/\\/www\\.terra\\.com\\.(br|mx|pe|co|ec|ve|es|ar)"],selectors:[{selector:"div[class=gs-title]>a",parent:!1,matched:0,inline:!0}]},{name:"xfinity",enabled:!0,sourcetype:a.c.XFINITY,urlre:["^http(s)?:\\/\\/search\\.xfinity\\.com"],selectors:[{selector:"ol.sr>li>h3>a",parent:!1,matched:0,inline:!0}]},{name:"web",enabled:!0,sourcetype:a.c.WEB,urlre:["^http(s)?:\\/\\/suche\\.web\\.de\\/web"],selectors:[{selector:"h3[class^=pos-web-result-list-item__title]>a",parent:!0,matched:0,inline:!0}]},{name:"biglobe",enabled:!0,sourcetype:a.c.BIGLOBE,urlre:["^http(s)?:\\/\\/cgi\\.search\\.biglobe\\.ne\\.jp\\/"],selectors:[{selector:"li>div[class^=sr-wrap]>div[class^=sr]>h3>a",parent:!0,matched:0,inline:!0}]},{name:"gmx",enabled:!0,sourcetype:a.c.GMX,urlre:["^http(s)?:\\/\\/suche\\.gmx\\.net\\/web"],selectors:[{selector:"h3[class^=pos-web-result-list-item__title]>a",parent:!1,matched:0,inline:!0}]},{name:"excite",enabled:!0,sourcetype:a.c.EXCITE,urlre:["^http(s)?:\\/\\/websearch\\.excite\\.co\\.jp"],selectors:[{selector:"section>div.item>h3.item_title>a",parent:!1,matched:0,inline:!0}]},{name:"naver",enabled:!0,sourcetype:a.c.NAVER,urlre:["^http(s)?:\\/\\/(web\\.)?search\\.naver\\.com\\/search\\.naver\\?"],selectors:[{selector:"dt.title_area>a",parent:!1,matched:0,inline:!0},{selector:"li>dl>dt>a",parent:!1,matched:0,inline:!0},{selector:"li.sh_blog_top>dl>dt>a",parent:!1,matched:0,inline:!0}]},{name:"nifty",enabled:!0,sourcetype:a.c.NIFTY,urlre:["^http(s)?:\\/\\/search\\.nifty\\.com\\/cgi\\-bin\\/search\\.cgi\\?","^http(s)?:\\/\\/(azby\\.)?search\\.nifty\\.com\\/websearch\\/search"],selectors:[{selector:"ul>li.unt>a",parent:!1,matched:0,inline:!0},{selector:"div.hd>h3>a",parent:!1,matched:0,inline:!0}]},{name:"rakuten",enabled:!0,sourcetype:a.c.RAKUTEN,urlre:["^http(s)?:\\/\\/(websearch|search)\\.rakuten\\.co\\.jp"],selectors:[{selector:"ul.os-result>li>a.os-window",parent:!1,matched:0,inline:!0}]},{name:"linkedin",socialMediaType:n.c.LINKEDIN,sourcetype:a.c.LINKEDIN,enabled:!1,urlre:["^http(s)?:\\/\\/(www\\.)?linkedin\\.com"],selectors:[{selector:"div.feed-shared-text>div>span a",excluderegex:"^http(s)?:\\/\\/(www\\.)?linkedin\\.com",parent:!1,matched:0,inline:!0},{selector:"a[data-control-name=page_details_module_website_external_link]",parent:!1,matched:0,inline:!0},{selector:"p.feed-shared-main-content > a",excluderegex:"^http(s)?:\\/\\/(www\\.)?linkedin\\.com",parent:!1,matched:0,inline:!0},{selector:"p.msg-s-event-listitem__body > a",excluderegex:"^http(s)?:\\/\\/(www\\.)?linkedin\\.com",parent:!1,matched:0,inline:!0}]},{name:"instagram",socialMediaType:n.c.INSTAGRAM,enabled:!1,sourcetype:a.c.INSTAGRAM,urlre:["^http(s)?:\\/\\/(www\\.)?instagram\\.com"],selectors:[{selector:"div.-vDIg>a.yLUwa",parent:!1,inline:!0,matched:0,hrefqstring:"u"}]},{name:"twitter",socialMediaType:n.c.TWITTER,enabled:!1,sourcetype:a.c.TWITTER,urlre:["^http(s)?:\\/\\/(www\\.)?twitter\\.com"],selectors:[{selector:"aside[aria-label=\"Relevant people\"] div>a:not([title=''])",parent:!1,inline:!0,matched:0,actualhref:"title",hrefqstring:"q"},{selector:"article div a:not([title=''])",parent:!1,inline:!0,matched:0,actualhref:"title",hrefqstring:"q"},{selector:"div.js-tweet-text-container a:not([title=''])",parent:!1,inline:!0,matched:0,actualhref:"title",hrefqstring:"q"}]},{name:"youtube",socialMediaType:n.c.YOUTUBE,enabled:!1,sourcetype:a.c.YOUTUBE,urlre:["^http(s)?:\\/\\/(www\\.)?youtube\\.com"],selectors:[{selector:"div[id=content]>yt-formatted-string[id=content-text]>a",parent:!1,inline:!0,matched:0,hrefqstring:"q"},{selector:"div[id=description] yt-formatted-string a",excluderegex:"^http(s)?:\\/\\/(www\\.)?youtube\\.com",parent:!1,inline:!0,insertIntoLink:!0,reProcessAnchor:!0,hrefqstring:"q",matched:0},{selector:"div[id=contents] > ytd-channel-video-player-renderer yt-formatted-string a",excluderegex:"^http(s)?:\\/\\/(www\\.)?youtube\\.com",parent:!1,inline:!0,hrefqstring:"q",insertIntoLink:!0,reProcessAnchor:!0,matched:0}]},{name:"reddit",socialMediaType:n.c.REDDIT,enabled:!1,sourcetype:a.c.REDDIT,urlre:["^http(s)?:\\/\\/(www\\.)?reddit\\.com"],selectors:[{selector:"div a.styled-outbound-link",excluderegex:"^http(s)?:\\/\\/(www\\.)?reddit\\.com",parent:!1,inline:!0,matched:0},{selector:'div[data-test-id="comment"] p > a',excluderegex:"^http(s)?:\\/\\/(www\\.)?reddit\\.com",parent:!1,inline:!0,matched:0}]}]}},4:function(e,t,s){"use strict";s.d(t,"e",function(){return r}),s.d(t,"d",function(){return i}),s.d(t,"f",function(){return o}),s.d(t,"g",function(){return c}),s.d(t,"h",function(){return l}),s.d(t,"b",function(){return E}),s.d(t,"a",function(){return _}),s.d(t,"i",function(){return h}),s.d(t,"c",function(){return S});var a=s(0),n=s(7);const r={WHITELIST:"whitelist",PREFERENCE:"preference",STATISTICS:"statistics",ABOUT:"about"},i={BROWSER_NAVIGATE:"Browser_Navigate",TYPOSQUATTING:"Typosquatting",BLOCK_PAGE:"Block_Page",SECURE_SEARCH_HIT:"Secure_Search_Hit",BROWSER_ACTION_CLICKED:"BrowserAction_Clicked",CRYPTOJACKING_BLOCK:"Cryptojacking_Block",SIDEBAR_PANEL:"SideBar_Panel",SMA_REPUTATION:"SMA_Reputation",ADBLOCK:{BUBBLE:"AdblockBubble",WHITELISTED:"AdblockWhitelisted"},DOWNLOAD_SCAN_UI:"Download_Scan_UI",DOWNLOAD_BLOCK:"Download_Block",SITE_REPORT:"SiteReport",BADGE:"Badge",PROFILE_INFO:"ProfileInfo",BROWSER_BADGE_UPDATE:"BrowserBadgeUpdate",GET_SEARCH_EXTENSION:"EmbedSearchExtension"},o={BROWSER_ACTION_CLICKED:"BrowserActionClicked",TYPOSQUATTING:"Typosquatting",BLOCK_PAGE:"BlockPage",SECURE_SEARCH_HIT:"SecureSearchHit",CRYPTOJACKING_BLOCK:"CryptojackingBlock",SIDEBAR_PANEL:"SideBarPanel",SMA_REPUTATION:"SMAReputation",DOWNLOAD_SCAN_UI:"DownloadScanUI",DOWNLOAD_BLOCK:"DownloadBlock"},c={IMPRESSION:"Impression",WEBADVISOR:"WebAdvisor",CRYPTOJACKING:{LEARN_MORE_CLICKED:"LearnMoreClicked",WHITELISTED:"Whitelisted"},SIDEBAR_PANEL:{SMA:"SocialMediaAnnotation",SMA_AUTO:"SocialMediaAnnotationAuto",MAIN:"Main"},DISMISSED:"Dismissed",HOVERED:"Hovered",CLOSE_CLICKED:"CloseClicked",ENABLE:"Enable",ADD:"Add",ADBLOCK:{DISMISS:"Dismiss",WHITELISTED:"Whitelisted",UNWHITELISTED:"Unwhitelisted"},PPS:{ACCEPT_RISK:"AcceptRisk",BLOCKED:"Blocked",ACKNOWLEDGED:"Acknowledged",GO_PROFILE:"GoProfile",WHITELIST_ADDED:"WhitelistAdded",WHITELIST_DELETED:"WhitelistDeleted",RESET_CLICKED:"ResetClicked"},BROWSER_BADGE:{SMA:"SMA"}},l={TOP:"Top",FRAME:"Frame",INLINE:"Inline"},E={EDUCATION:"Education",NORMAL:"Normal"},_={ACCEPT_SECURE_SEARCH:"AcceptSecureSearch",BLOCK_BAD_PAGE:"BlockBadPage",DELETE_BAD_DOWNLOAD:"DeleteBadDownload"},d={ABOUT:"About",PREFERENCES:"Preferences",WHITELIST:"Whitelist",STATS:"UserStatistics"},u={UNKNOWN:"UNKNOWN",RED:"Red",YELLOW:"Yellow"},T={GREEN:"Green",YELLOW:"Yellow",RED:"Red",UNKNOWN:"UNKNOWN",HACKERSAFE:"Hackersafe",TYPOSQUATTING:"Typosquatting",PHISHING:"Phishing"},h={DEFAULT:"DefaultSearch"};class S{static toColorTelemetry(e){let t=u.UNKNOWN;switch(e){case a.d.RED:t=u.RED;break;case a.d.YELLOW:t=u.YELLOW}return t}static toTelemetryBlockState(e){let t=T.UNKNOWN;switch(e){case a.a.GREEN:t=T.GREEN;break;case a.a.YELLOW:t=T.YELLOW;break;case a.a.RED:t=T.RED;break;case a.a.HACKERSAFE:t=T.HACKERSAFE;break;case a.a.TYPOSQUATTING:t=T.TYPOSQUATTING;break;case a.a.PHISHING:t=T.PHISHING}return t}static toTelemetrySettingTab(e){let t=d.PREFERENCES;switch(e){case r.WHITELIST:t=d.WHITELIST;break;case r.STATISTICS:t=d.STATS;break;case r.ABOUT:t=d.ABOUT}return t}static getBrowserActionClicked(e){const t={};return t.name=o.BROWSER_ACTION_CLICKED,t.interaction_type=c.WEBADVISOR,t.browser=n.a.browserTypeToString(),t.badge_count=e,t._event_name=i.BROWSER_ACTION_CLICKED,t}static getSideBarPanelAction(e){const t={};return t.name=o.SIDEBAR_PANEL,t.interaction_type=e,t.browser=n.a.browserTypeToString(),t._event_name=i.SIDEBAR_PANEL,t}static getBlockPage(e,t,s,a){const r={};return r.name=o.BLOCK_PAGE,r.interaction_type=t,r.browser=n.a.browserTypeToString(),r.colour=S.toColorTelemetry(e),r.level=s,r.style=a||"UNKNOWN",r._event_name=i.BLOCK_PAGE,r}}},5:function(e,t,s){"use strict";var a=s(0),n=s(13),r=s(11),i=s(14),o=s(3),c=s(1),l=s(2);s.d(t,"a",function(){return E});const E={uid:"0DE9E47C-871A-4F90-8440-B190C216800A",browserType:a.c.BROWSER_TYPE,annotationProperties:{properties:{HACKERSAFE:{highlightColor:"#CCFFCC",color:"green",width:68,height:16,icon:"images/annotation/hackersafe_icon.svg"},CERTIFIED:{highlightColor:"#CCFFCC",color:"green",width:16,height:16,icon:"images/annotation/green_icon.svg"},OK:{highlightColor:"#CCFFCC",color:"green",width:16,height:16,icon:"images/annotation/green_icon.svg"},INFO:{highlightColor:"#F7F995",color:"yellow",width:16,height:16,icon:"images/annotation/yellow_icon.svg"},WARN:{highlightColor:"#FFAAAA",color:"red",width:16,height:16,icon:"images/annotation/red_icon.svg"},UNKNOWN:{highlightColor:"#FFFFFF",color:"white",width:16,height:16,icon:"images/annotation/white_icon.svg"}}},balloonProperties:{properties:{logoImage:"images/web_advisor/logo.png",hackerSafeImage:"images/balloon/hackersafe_icon.png",width:"325px",appearance:{color_4:{srcImage:"images/balloon/green_icon.png",backgroundColor:"#0BD175"},color_0:{srcImage:"images/balloon/green_icon.png",backgroundColor:"#0BD175"},color_1:{srcImage:"images/balloon/yellow_icon.png",backgroundColor:"#FF9900"},color_2:{srcImage:"images/balloon/red_icon.png",backgroundColor:"#F1342F"},color_3:{srcImage:"images/balloon/white_icon.png",backgroundColor:"#768F99"}}}},externalExtensions:new i.a,externalMsgDispatcher:new class{isvalidRequestType(e){let t=!1;for(const s in l.d)l.d[s]===e&&(t=!0);return t}validateMsg(e,t){return!(void 0===e||void 0===t||!this.isvalidRequestType(e))||(o.a.logError("Invalid msg to be sent externally"),!1)}sendExtnMsg(e,t,s){const{request_type:a,payload:n}=t;if(this.validateMsg(a,n))return new Promise((a,n)=>{c.a.runtime.sendMessage(e,t,e=>{"function"==typeof s?s(a,n,e):((e,t,s)=>{c.a.runtime.lastError&&t(c.a.runtime.lastError.message),e(s)})(a,n,e)})})}},reputationReqCount:5,imageCounter:0,isSearchPage:!1,isSearchHitSend:!1,resourceRequestor:null,gtiRequestor:null,clientFunctions:null,activeURI:null,mapSelectors:null,eventHandler:null,bkGlobals:null,searchEngine:null,searchAnnotationOption:r.a.ONLY_SECURE_SEARCH,socialMediaOption:n.c.NONE,socialMediaToggle:!1,PPS_MODE:a.c.PPS_MODE}},6:function(e,t,s){"use strict";var a=s(1),n=s(8);class r{static set(e,t){const s={};s[e]=t,a.a.storage.local.set(s)}static get(e){return new Promise(t=>a.a.storage.local.get(e,s=>((t,s)=>{t(s[e]||null)})(t,s)))}static clear(e){a.a.storage.local.remove(e)}}var i=s(18),o=s(9);var c=s(14),l=s(0);s.d(t,"a",function(){return E});const E={adblockManager:null,binaryVersion:"0.0.0.0",cacheStore:new class{constructor(){this.initialized=!1;for(const e of Object.values(n.c))this[e]=null;for(const e of Object.values(n.a))this[e]=null;this.init()}init(){const e=[];for(const t of Object.values(n.c))e.push(r.get(t).then(e=>{const s={};return s.storeVariable=t,s.result=e,s}));Promise.all(e).then(e=>{e.forEach(({storeVariable:e,result:t})=>{this[e]=t||null}),this.initialized=!0})}isInit(){return this.initialized}get(e){return this[e]}set(e,t){this[e]=t,n.c[e]&&r.set(e,t)}clear(e){this[e]&&(this[e]=null,n.c[e]&&r.clear(e))}},externalExtensions:new c.a,ffViewports:null,gtiCache:new class{constructor(){this._reputationCache=new Map,this._GTIRequestsInProgress=new Set,this.setCleanUpTimer()}setCleanUpTimer(){setInterval(()=>{this._reputationCache.size>.5*o.a.MAX_CACHE_RECORDS&&this.cleanReputationCache()},36e5)}cleanReputationCache(){this._reputationCache.forEach((e,t,s)=>{Date.now()>i.b.reputationTTL+e.timeCached&&s.delete(t)})}addInProgress(e){this._GTIRequestsInProgress.add(e)}deleteInProgress(e){this._GTIRequestsInProgress.delete(e)}isInProgress(e){return this._GTIRequestsInProgress.has(e)}setReputation(e,t){return!(this._reputationCache.size>o.a.MAX_CACHE_RECORDS||(this._reputationCache.set(e,{timeCached:Date.now(),value:t}),0))}getReputation(e){const t=this._reputationCache.get(e),s={cache_entry:t};return t||(s.cache_entry=null),s}},lastUrl:null,logger:null,messageDispatcher:null,messageQueue:new Map,port:null,tabData:new Map,tabFrames:{},tabIdToLastClickTime:new Map,useNativeLogger:!1,wasm:null,userAgentInBase64:null,cspId:o.b.SETTINGS.CSP_ID_DEFAULT_VALUE,AFFID:"0",BINARY_VERSION:"0.0.0.0",AP_FEATURE_ENABLED:!1,AUTO_PLAY_NOTIFICATION_ENABLED:!1,BUILTIN_FF_TOAST_MODE:0,CRYPTOJACKING_FEATURE_DISABLED:!1,SECURE_SEARCH_PROVIDER:-1,SECURE_SEARCH_REGEXES:[],SMA_FEATURE_DISABLED:!0,SS_DEF:0,PPS_MODE:l.c.PPS_MODE}},7:function(e,t,s){"use strict";s.d(t,"a",function(){return l});var a=s(0),n=s(9),r=s(1),i=s(15),o=s(5),c=s(6);class l{static toGTICategoriesString(e,t=!1){const s=[];for(const a of e){const e=parseInt(a,10);isNaN(e)||i.a.getResString(`category_id_${e}_name`,a=>{const n={};if(n.name=a,!t)return s.push(n);i.a.getResString(`category_id_${e}_description`,e=>{n.description=e,s.push(n)})})}return s}static setTabUrl(e,t){let s=c.a.tabData.get(e);void 0===s&&(c.a.tabData.set(e,{}),s=c.a.tabData.get(e)),s.url=t}static setTabBlockPageData(e,t){let s=c.a.tabData.get(e);void 0===s&&(c.a.tabData.set(e,{}),s=c.a.tabData.get(e)),s.blockPageData=t}static getBrowserSuffix(){const{CH:e,FF:t,EDGE:s}=n.b.BROWSER_SUFFIX,r={};return r[a.b.EDGE]=s,r[a.b.FIREFOX]=t,r[a.b.CHROME]=e,r[a.c.BROWSER_TYPE]}static browserTypeToString(){switch(a.c.BROWSER_TYPE){case 1:return"FF";case 2:return"CH";case 3:return"ISB";case 4:return"ED";default:return"UN"}}static toImagePaths(e){let t="images/browser_action/";switch(e.startsWith("small_")?e:`small_${e}`){case"small_button_green.gif":t+="green";break;case"small_button_yellow.gif":t+="yellow";break;case"small_button_red.gif":t+="red";break;case"small_button_grey.gif":t+="white";break;case"small_button_hs.gif":t+="hackersafe";break;case"small_button_disabled.gif":t+="disabled";break;default:t+=e}return{size16:`${t}_16.png`,size20:`${t}_20.png`,size32:`${t}_32.png`,size40:`${t}_40.png`}}static colorToImagePaths(e){let t="white";switch(e){case a.d.GREEN:t="green";break;case a.d.YELLOW:t="yellow";break;case a.d.RED:t="red";break;case a.d.UNKNOWN:t="white";break;case a.d.HACKERSAFE:t="hackersafe";break;case a.d.DISABLED:t="disabled"}return l.toImagePaths(t)}static toAnnotationImageClass(e){let t="";switch(l.toColor(e)){case a.d.GREEN:t="OK";break;case a.d.RED:t="WARN";break;case a.d.YELLOW:t="INFO";break;case a.d.HACKERSAFE:t="HACKERSAFE";break;case a.d.UNKNOWN:t="UNKNOWN"}return t}static isPhishingURI(e){return e&&e.includes(n.a.PHISHING_CATEGORY)}static getIFrameBlockPageUrl(){return r.a.runtime.getURL("html/iframe_block_page.html")}static toBlockState(e){const t=l.toColor(e);return t!==a.d.RED&&t!==a.d.YELLOW||!l.isPhishingURI(e.cat)?isNaN(t)?a.a.UNKNOWN:t:a.a.PHISHING}static toColor(e){let t=a.d.UNKNOWN;return t=e.rep<a.k.MINIMAL?l.isHackerSafe(e.ufg)?a.d.HACKERSAFE:a.d.GREEN:e.rep<a.k.UNKNOWN?a.d.UNKNOWN:e.rep<a.k.MEDIUM?a.d.YELLOW:a.d.RED}static toSiteReportUrl(e){const t=r.a.runtime.getURL("html/site_report.html");return o.a.PPS_MODE?"#":`${t}?url=${escape(e)}`}static isExtensionUrl(e){if(a.b.CHROME===a.c.BROWSER_TYPE&&e.startsWith(`chrome-extension://${r.a.runtime.id}`)||a.b.EDGE===a.c.BROWSER_TYPE&&e.startsWith(`ms-browser-extension://${r.a.runtime.id}`))return!0;if(a.b.FIREFOX===a.c.BROWSER_TYPE){let t=r.a.i18n.getMessage("@@extension_id");if(!t){const e=r.a.runtime.getURL("images/web_advisor/logo.png").split("/");t=e.length>=3?e[2]:""}return t&&e.startsWith(`moz-extension://${t}`)}return!1}static isHackerSafeUrl(e){return!(!e.startsWith(`http://${n.a.SITE_ADVISOR_URL}`)&&!e.startsWith(`https://${n.a.SITE_ADVISOR_URL}`))||l.isExtensionUrl(e)}static isHackerSafe(e){return 1&e}static isProperWebURL(e){return!!(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("ftp://"))}static isSearchEngineResultPage(e,t){return t.some(t=>{for(const s of t.urlre){if(null!==e.match(new RegExp(s,"i")))return!0}return!1})}static getUINumber(e){if(e>=1e4)return"10k+";if(e>=1e3){let t=(e/1e3).toFixed(1);return`${t="0"===t.substring(2,3)?t.substring(0,1):t}k+`}return`${e}`}}},8:function(e,t,s){"use strict";s.d(t,"b",function(){return a}),s.d(t,"c",function(){return n}),s.d(t,"a",function(){return r});const a={SET:"SET",GET:"GET",CLEAR:"CLEAR"},n={BLOCK_PAGE_WHITELIST:"BLOCK_PAGE_WHITELIST",CRYPTO_WHITELIST:"CRYPTO_WHITELIST",TYPOSQUATTING_WHITELIST:"TYPOSQUATTING_WHITELIST",POPUP_STATS:"POPUP_STATS",WHITELIST_FLAG:"WHITELIST_FLAG",EXTENSION_LOGGING:"EXTENSION_LOGGING",SEARCH_ANNOTATION_OPTION:"SEARCH_ANNOTATION_OPTION",SMA_LAST_SHOWN:"SMA_LAST_SHOWN",SMA_NOTIFICATION_TRIGGER_STATE:"SMA_NOTIFICATION_TRIGGER_STATE",SOCIAL_MEDIA_ANNOTATION_OPTION:"SOCIAL_MEDIA_ANNOTATION_OPTION",SOCIAL_MEDIA_ANNOTATION_TOGGLE:"SOCIAL_MEDIA_ANNOTATION_TOGGLE",AP_USER_TOGGLE:"AP_USER_TOGGLE",AB_USER_TOGGLE:"AB_USER_TOGGLE",IS_SECURE_SEARCH_SET:"IS_SECURE_SEARCH_SET",USER_ACCEPTED_TOAST_ONCE:"USER_ACCEPTED_TOAST_ONCE",BLOCK_PAGE_RED_FIRST_VARIANT_COUNT:"BLOCK_PAGE_RED_FIRST_VARIANT_COUNT",BLOCK_PAGE_YELLOW_FIRST_VARIANT_COUNT:"BLOCK_PAGE_YELLOW_FIRST_VARIANT_COUNT",BLOCK_PAGE_PHISHING_FIRST_VARIANT_COUNT:"BLOCK_PAGE_PHISHING_FIRST_VARIANT_COUNT",IFRAME_BLOCK_FIRST_TIME:"IFRAME_BLOCK_FIRST_TIME"},r={CACHE_TYPOQUATTING:"CACHE_TYPOQUATTING",SS_TOAST_ACCEPTED:"SS_TOAST_ACCEPTED",USER_ACCEPTED_ADBLOCK_TOAST:"USER_ACCEPTED_ADBLOCK_TOAST",DOWNLOAD_SCANNING_QUEUE:"DOWNLOAD_SCANNING_QUEUE"}},9:function(e,t,s){"use strict";s.d(t,"a",function(){return a}),s.d(t,"b",function(){return n});const a={MAX_CACHE_RECORDS:1e3,MAX_RESERVED_CALLBACK_ID:5,PHISHING_CATEGORY:169,SITE_ADVISOR_URL:"www.siteadvisor.com/"},n={SCOPE:{SYSTEM:0,USER:1},SETTINGS_TYPE:{NONE:0,INT:1,INT64:2,BOOL:3,STRING:4},BROWSER_SUFFIX:{CH:"_ch",FF:"_ff",IE:"_ie",EDGE:"_edge"},SETTINGS:{AFF_ID:"*Affid",BROWSER_TYPE:"browsertype",PROVIDER_FORCED:"ProviderForced",USE_NATIVE_LOGGER:"UseNativeLogger",SYSTEM_GEO:"SystemGEO",USER_AGENT:"useragent",VIEWPORT:"viewport",CRYPTOJACKING_DISABLED:"CryptojackingDisabled",BLOCKPAGE_WHITELIST:"*WhiteList",TS_WHITELIST:"*TListWhiteList",BING_COUNTRY_SET:"BingCountrySet",BING_COUNTRY_SET_STRING:"AU,DE",BING_PARTNER_CODE:"PC=MC",SECURE_SEARCH_TOAST_STAMP:"*SSDateStampShowedToast",SECURE_SEARCH_REGEXES:"SECURE_SEARCH_REGEXES",SECURE_SEARCH_ANNOTATION_ONLY:"*OnlyShowAnnotationsOnSecureSearch",SECURE_SEARCH_SHOW_ICONS:"*Icons",SECURE_SEARCH_CHOICE:"*SSToastChoice",SS_DEF:"*SS_DEF",CHECKLIST_START_INGORE_DATE_AV:"startIgnoreDateAV",CHECKLIST_START_IGNORE_DATE_FW:"startIgnoreDateFW",CHECKLIST_IGNORE_DURACTION:"ignoreDuration",CHECKLIST_GRACE_PERIOD_AV:"fixGracePeriodStartDateAV",CHECKLIST_GRACE_PERIOD_FW:"fixGracePeriodStartDateFW",CHECKLIST_GRACE_PERIOD_DURATION:"fixGracePeriodDuration",WEBBOOST_AUTO_PLAY_NOTIFICATION:"AutoPlayNotificationRequired",WEBBOOST_UPSELL_DISABLED:"WBUpsellDisabled",SMA_DISABLED:"sma_feature_disabled",SMA_ANNOTATION_OPTIONS:"sma_annotation_options",SMA_USER_TOGGLE:"sma_user_toggle",BUILTIN_FF_TOAST_MODE:"builtin_ff_toast_mode",PAGES_SCANNED:"*CounterPagesScanned",PAGES_BLOCKED:"*CounterPagesBlocked",DOWNLOADS_SCANNED:"*CounterDownloadsScanned",DOWNLOADS_BLOCKED:"*CounterDownloadsBlocked",CRYPTO_BLOCKED:"*CounterCryptoJackingBlocked",ADBLOCK_TOAST:"adblock_toast",AP_USER_TOGGLE:"ap_user_toggle",AB_USER_TOGGLE:"ab_user_toggle",ADBLOCK_REENABLE_TOAST:"adblock_reenable_toast",CSP_ID_SETTING_NAME:"CSPIdValue",CSP_ID_DEFAULT_VALUE:"__not_available__"}}}});